
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>8.4. 분류의 평가 &#8212; 빅데이터 개론 2</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystyle.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="8.3. 분류와 예측모형" href="classification.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">빅데이터 개론 2</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    빅데이터 개론 2
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01/intro-course.html">
   1. 서론
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/intro-program.html">
     1.1. 프로그래밍 언어
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/intro-stat.html">
     1.2. 통계학
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02/intro-python.html">
   2. 파이선의 기초
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/basic-expression.html">
     2.1. 표현식과 변수
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/data-processing-intro.html">
     2.2. 데이터의 처리
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/data-processing-train-passenger.html">
     2.3. 고속열차 여객 수송자료
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/data-processing-text.html">
     2.4. 어린 왕자
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03/types.html">
   3. 자료의 형식
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/numbers.html">
     3.1. 숫자
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/string.html">
     3.2. 문자열
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/array.html">
     3.3. 행렬
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../04/dataframe.html">
   4. 데이터프레임
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../04/dataframe-intro.html">
     4.1. 데이터프레임의 정의와 구성요소
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04/dataframe-change.html">
     4.2. 데이터프레임의 정리
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04/dataframe-summary.html">
     4.3. 데이터프레임의 요약
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04/dataframe-merge.html">
     4.4. 데이터프레임의 결합
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../05/data-intro.html">
   5. 분포와 확률
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/data_distribution.html">
     5.1. 자료의 분포
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/data_randomness.html">
     5.2. 분포와 우연성
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/data_random_experiment.html">
     5.3. 확률과 컴퓨터 실험
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/data_probability.html">
     5.4. 확률의 기초
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/data_function.html">
     5.5. 함수
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../06/sampling-intro.html">
   6. 표본과 경험적 분포
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/sample.html">
     6.1. 표본과 정보
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/samplemeans.html">
     6.2. 통계량의 분포
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/estimator.html">
     6.3. 추정량의 성질
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/bootstrap.html">
     6.4. 붓스트랩
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../07/test-intro.html">
   7. 유의성 검정
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../07/decision.html">
     7.1. 선택과 증거
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07/pvalue.html">
     7.2. 유의성 검정
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07/abtest.html">
     7.3. 두 그룹의 비교
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="relation-intro.html">
   8. 관계와 예측
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="correlation.html">
     8.1. 두 변수의 관계
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="regression.html">
     8.2. 선형 회귀모형
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="classification.html">
     8.3. 분류와 예측모형
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     8.4. 분류의 평가
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/UOS-Bigdata/bigdatabook/master?urlpath=tree/chapters/08/validation.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/UOS-Bigdata/bigdatabook/blob/master/chapters/08/validation.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/UOS-Bigdata/bigdatabook"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/chapters/08/validation.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   8.4.1. 분류의 평가 기준
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   8.4.2. 학습 데이터와 평가 데이터
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   8.4.3. 심장병 데이터
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   8.4.4. 데이터 전처리
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   8.4.5. 모형의 적합
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   8.4.6. 예측의 정확성
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id8">
   8.4.7. 기계학습 방법의 평가
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id9">
   8.4.8. 정리
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>분류의 평가</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   8.4.1. 분류의 평가 기준
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   8.4.2. 학습 데이터와 평가 데이터
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   8.4.3. 심장병 데이터
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   8.4.4. 데이터 전처리
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   8.4.5. 모형의 적합
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   8.4.6. 예측의 정확성
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id8">
   8.4.7. 기계학습 방법의 평가
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id9">
   8.4.8. 정리
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1><span class="section-number">8.4. </span>분류의 평가<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h1>
<p>필요한 패키지와 라이브러리 설치하고 사용할 함수를 먼저 정의한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 한글 폰트가 깨질 때 사용 - 런타임 메뉴에서 다시 시작 및 모두 실행 선택. (출처: https://teddylee777.github.io/colab/colab-korean)</span>
<span class="o">!</span>sudo apt-get install -y fonts-nanum
<span class="o">!</span>sudo fc-cache -fv
<span class="o">!</span>rm ~/.cache/matplotlib -rf
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pandas 라이브러리의 탐색적 데이터 분석 도구(explanatory data analysis tool, profiling)를 설치한다.</span>
<span class="o">!</span>pip install -U pandas-profiling
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pandas_profiling</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;NanumBarunGothic&#39;</span><span class="p">)</span> <span class="c1"># clolab 에서 한글 사용 </span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.unicode_minus&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>   <span class="c1"># 그림 크기 조정</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#기계학습 모형</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>

<span class="c1"># 기계학습 평가 도구</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">f1_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 표준화 함수</span>
<span class="k">def</span> <span class="nf">standarize</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h2><span class="section-number">8.4.1. </span>분류의 평가 기준<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<p>앞 절에서 이항 변수(binary variable)을 예측하는 분류 방법들을 알아보았다.</p>
<p>분류에 사용된 기계학습 모형이 얼마나 분류를 잘 수행하였는지 평가하는 기준이 있어야 서로 다른 방법들을 비교할 수 있다.</p>
<p>학습데이터에 포함된 반응변수의 값 <span class="math notranslate nohighlight">\(y\)</span> 과 적합된 모형을로 부터 에측된 값 <span class="math notranslate nohighlight">\(\hat y\)</span> 을 비교하여 일치하는 비율을 <strong>예측의 정확성(prediction accuracy)</strong> 이라고 하며 예측모형을 평가하는 가장 기본적인 측조이다.</p>
<div class="math notranslate nohighlight">
\[ \text{Accuracy } = \frac{\text{ number of records for which } y_i = \hat y_i}{n} \]</div>
</section>
<section id="id3">
<h2><span class="section-number">8.4.2. </span>학습 데이터와 평가 데이터<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h2>
<p>예측의 정확성을 계산할 때 주의할 점은 모형의 적합에 사용된 데이터와 평가를 수행하는 데이터가 일치하면 모형의 실제 정확성을 과대 추정할 수 있는 위험성이 있다는 것이다.</p>
<p>우리가 자신에 대한 평가를 하는 경우를 생삿해 보자. 내가 나 자신을  평가하면  다른 사람들이 나를 평가하는 것보다 더 좋은 평가를 내릴 위험성이 크다는 의미이다.</p>
<p>따라서 모형의 공정하고 정확한 평가를 수행하기 위해서는 사용할 수 잇는 데이터를 다음과 같이 두 개로 나누어야 한다.</p>
<ul class="simple">
<li><p><strong>학습 데이터(training data)</strong> : 모형을 적합하고 계수를 추정하는데 사용되는 데이터</p></li>
<li><p><strong>검증 데이터(test data, validation data)</strong> : 모형의 예측 능력을 평가하는 데이터</p></li>
</ul>
<p><img alt="학습데이터, 검증데이터" src="https://scikit-learn.org/stable/_images/grid_search_workflow.png" /></p>
</section>
<section id="id4">
<h2><span class="section-number">8.4.3. </span>심장병 데이터<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h2>
<p>심혈관 질환(Cardiovascular disease)은 전 세계 사망 원인 1위이며 매년 약 1,790만 명이 사망하며 이는 전 세계 사망의 31%를 차지한다. 심혈관 질환으로 인한 사망 5건 중 4건은 심장마비와 뇌졸중으로 인한 것이며, 이 중 3분의 1은 70세 미만에서 조기에 발생한다.</p>
<p>이 절에서 이용할 자료는 <a class="reference external" href="https://www.kaggle.com/fedesoriano/heart-failure-prediction?select=heart.csv">Kaggle</a>
에서 얻을 수 있는 공공 데이터 세트이며 심장 질환을 예측하는 데 사용할 수 있는 11가지 변수가 포함된 자료이다.</p>
<p>자료를 다운로드 하여 데이터프레임 <code class="docutils literal notranslate"><span class="pre">heart</span></code> 에 저장하자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://ilovedata.github.io/teaching/bigdata2/data/heart.csv&quot;</span>
<span class="n">heart</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heart</span><span class="p">[</span><span class="s1">&#39;FastingBS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">heart</span><span class="p">[</span><span class="s1">&#39;FastingBS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">heart</span><span class="p">[</span><span class="s1">&#39;HeartDisease&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">heart</span><span class="p">[</span><span class="s1">&#39;HeartDisease&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heart</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heart</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>데이터프레임 <code class="docutils literal notranslate"><span class="pre">heart</span></code> 의 각 열에 대한 설명은 다음과 같다. 마지막 변수 <code class="docutils literal notranslate"><span class="pre">HeartDisease</span></code> 가 반응변수이며 나머지는 모두 설명변수이다.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>Feature</p></th>
<th class="text-align:left head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>Age</p></td>
<td class="text-align:left"><p>연령 (연)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Sex</p></td>
<td class="text-align:left"><p>성별 (M: 남성, F: 여성)</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>ChestPainType</p></td>
<td class="text-align:left"><p>가슴의 통증 분류 [TA: 전형적인 협심증 통증(Typical Angina), ATA: 비전형적 협심증(Atypical Angina, NAP: 비협심증 통증(Non-Anginal Pain), ASY: 없음)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>RestingBP</p></td>
<td class="text-align:left"><p>혈압 (mm Hg)</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>Cholesterol</p></td>
<td class="text-align:left"><p>콜레스테롤 (mm/dl)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>FastingBS</p></td>
<td class="text-align:left"><p>공복혈당 (1: 만약 공복혈당 &gt; 120 mg/dl, 0: 아니면)</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>RestingECG</p></td>
<td class="text-align:left"><p>심전도 결과 (Normal: Normal, ST: having ST-T wave abnormality (T wave inversions and/or ST elevation or depression of &gt; 0.05 mV), LVH: showing probable or definite left ventricular hypertrophy by Estes’ criteria)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>MaxHR</p></td>
<td class="text-align:left"><p>최대 심박수 (60 과 202 사이의 숫자)</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>ExerciseAngina</p></td>
<td class="text-align:left"><p>운동 유발성 협심증 (Y: 예, N: 아니오)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>Oldpeak</p></td>
<td class="text-align:left"><p>oldpeak = ST (Numeric value measured in depression)</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>ST_Slope</p></td>
<td class="text-align:left"><p>the slope of the peak exercise ST segment (Up: upslo ping, Flat: flat, Down: downsloping)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>HeartDisease</p></td>
<td class="text-align:left"><p>결과 (1: 심장병 있음, 0: 심장병 없음)</p></td>
</tr>
</tbody>
</table>
<p>각 변수에 대한 분포를 구하고 기초 통계량과 상관관계를 살펴 보자. 데이터에 대한 탐색적 분석을 위하여 <code class="docutils literal notranslate"><span class="pre">pandas</span></code> 라이브러리에서 제공하는 <code class="docutils literal notranslate"><span class="pre">profile_report()</span></code> 메소드를 사용해보자. <code class="docutils literal notranslate"><span class="pre">profile_report()</span></code>는 여러 가지 다양한 통계량을 일목요연하게 HTML 형식으로 나타내어 준다. <code class="docutils literal notranslate"><span class="pre">profile_report()</span></code> 를 이용하려면 터미널에서 다음과 같이 패키지를 설치해야 한다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">U</span> <span class="n">pandas</span><span class="o">-</span><span class="n">profiling</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 다음 코드는 꼭 colab 에서 실행시키세요</span>

<span class="n">heart</span><span class="o">.</span><span class="n">profile_report</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h2><span class="section-number">8.4.4. </span>데이터 전처리<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h2>
<p>데이터프레임 <code class="docutils literal notranslate"><span class="pre">heart</span></code>에는 연속형 설명변수와 범주형 설명변수가 같이 포함되어 있다. 아래 코드에서 <code class="docutils literal notranslate"><span class="pre">info()</span></code> 메소드는 데이터프레임의 야에 대한 자료의 형식을 나타내는 것이다. 형식 <code class="docutils literal notranslate"><span class="pre">Dtype</span></code> 이 <code class="docutils literal notranslate"><span class="pre">object</span></code> 로 나타나는 열이 범주형 변수이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heart</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>설명변수가 범주형인 경우 기계학습 모형을 이용하기 위해서는 각 범주형 변수에 대한 가변수(dummy variable)을 만들어 주어야 한다. 가변수는 범주의 개수보다 하나 작은 개수의  연속형 변수들를 만들어 주는 것이다.</p>
<p>예를 들어 변수 <code class="docutils literal notranslate"><span class="pre">RestingECG</span></code> 는 <code class="docutils literal notranslate"><span class="pre">Normal</span></code>, <code class="docutils literal notranslate"><span class="pre">LVS</span></code>, <code class="docutils literal notranslate"><span class="pre">ST</span></code>  세 가지 범주로 구성되어 있다면 두 개의 연속형 변수 <code class="docutils literal notranslate"><span class="pre">RestingECG_Normal</span></code>, <code class="docutils literal notranslate"><span class="pre">	RestingECG_ST</span></code>를 만들어 다음과 같이 범주를 나타내는 것이다.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>원래변수 <code class="docutils literal notranslate"><span class="pre">RestingECG</span></code> 의 값</p></th>
<th class="text-align:center head"><p><code class="docutils literal notranslate"><span class="pre">RestingECG_Normal</span></code></p></th>
<th class="text-align:center head"><p><code class="docutils literal notranslate"><span class="pre">	RestingECG_ST</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p><code class="docutils literal notranslate"><span class="pre">Normal</span></code></p></td>
<td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>0</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p><code class="docutils literal notranslate"><span class="pre">ST</span></code></p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>1</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p><code class="docutils literal notranslate"><span class="pre">LVS</span></code></p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>0</p></td>
</tr>
</tbody>
</table>
<p>먼저 메소드 <code class="docutils literal notranslate"><span class="pre">select_dtypes(include=object).columns</span></code>를 이용하여 범주형 변수로 구성된 모든 열의 이름을 <code class="docutils literal notranslate"><span class="pre">cat_col_names</span></code>에 저장한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 범주형 변수로 구성된 모든 열의 이름 추출</span>
<span class="n">cat_col_names</span> <span class="o">=</span> <span class="n">heart</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>
<span class="n">cat_col_names</span>
</pre></div>
</div>
</div>
</div>
<p>다음으로 메소드 <code class="docutils literal notranslate"><span class="pre">get_dummies(heart,</span> <span class="pre">cat_col_names,</span> <span class="pre">drop_first=True)</span></code> 를 사용하여 가변수를 생성하자. 가변수를 포함한 데이터프레임은 <code class="docutils literal notranslate"><span class="pre">heart2</span></code> 에 저장한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 범주형변수에 대한 가변수를 생성하고 새로운 데이터 프레임에 저장한다. </span>
<span class="n">heart2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">heart</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cat_col_names</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
<span class="n">heart2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">heart2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span> <span class="s2">&quot;MaxHR&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span> <span class="s2">&quot;Cholesterol&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;HeartDisease&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;deep&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>이제 앞에서 언급한 것처럼 전체 데이터를  학습 데이터와 검증 데이터로 나눌 것이다.</p>
<p>먼저 반응변수 <code class="docutils literal notranslate"><span class="pre">HeartDisease</span></code> 와 독립변수들을 나누어서 저장하자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 독립변수들 </span>
<span class="n">X</span> <span class="o">=</span>  <span class="n">heart2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;HeartDisease&#39;</span><span class="p">)</span>
<span class="c1"># 표준화</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">standarize</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 반응변수 </span>
<span class="n">y</span> <span class="o">=</span> <span class="n">heart</span><span class="p">[</span><span class="s1">&#39;HeartDisease&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>이제 반응변수 행렬 <code class="docutils literal notranslate"><span class="pre">y</span></code> 와 독립변수 행렬 <code class="docutils literal notranslate"><span class="pre">X</span></code> 를 각각 학습데이터와 검증데이터로 나눈다.</p>
<p>학습데이터와 검증데이터로 나눈 떄는 함수 <code class="docutils literal notranslate"><span class="pre">train_test_split()</span></code> 을 사용한다. <code class="docutils literal notranslate"><span class="pre">test_size</span></code> 는 0과 1 사이의 비율이며 검증 데이터가 전체 자료에서 차지하는 비율을 지정한다. 검증데이터는 원 자료에서 임의로 추출된다.</p>
<p>아래 파이썬 코드는 <code class="docutils literal notranslate"><span class="pre">heart2</span></code> 데이처프레임에서 30% 의 자료를 검증 데이터로 추출하는 것이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 학습데이터와 검증데이터로 나누기</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">112</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h2><span class="section-number">8.4.5. </span>모형의 적합<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h2>
<p>이제 학습 데이터를 이용하여 로지스틱 회귀 모형을 적합시켜 보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 로지스틱 회귀모형 정의</span>
<span class="n">heart2_logistic_model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>

<span class="c1"># 모형적합</span>
<span class="n">heart2_logistic_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>로지스틱 회귀모형을 추정된 계수를 보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># beta0</span>
<span class="n">b0</span> <span class="o">=</span> <span class="n">heart2_logistic_model</span><span class="o">.</span><span class="n">intercept_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># beta1, beta2 </span>
<span class="n">heart2_logistic_model</span><span class="o">.</span><span class="n">coef_</span><span class="o">.</span><span class="n">T</span>

<span class="n">b0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">heart2_logistic_model</span><span class="o">.</span><span class="n">coef_</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id7">
<h2><span class="section-number">8.4.6. </span>예측의 정확성<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h2>
<p>이제 마지막으로 검증 데이터에 적합된 모형을 사용하여 예측의 정확성를 구해보자. 예측의 정확성 비율은 함수 <code class="docutils literal notranslate"><span class="pre">accuracy_scrore(y_true,</span> <span class="pre">y_new)</span></code>를 이용하여 계산한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 검증 데이터에 대한 예측값 생성 </span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">heart2_logistic_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="c1"># 에측의 정확성 계산</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy: </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;y_true&#39;</span><span class="p">:</span><span class="n">y_test</span><span class="p">,</span> <span class="s1">&#39;y_pred&#39;</span><span class="p">:</span> <span class="n">y_pred</span> <span class="p">})</span>
<span class="n">df_test</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>참고로 검증자료가 없고 전체 자료를 학습 데이터로 이용하여 모형을 적합하고 동일한 학습데이터로 예측의 정확성을 계산해 보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 로지스틱 회귀모형 정의</span>
<span class="n">heart2_logistic_model_A</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>

<span class="c1"># 전체 데이터를 이용한 모형적합</span>
<span class="n">heart2_logistic_model_A</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 전체 데이터에 대한 예측값 생성 </span>
<span class="n">y_pred_A</span> <span class="o">=</span> <span class="n">heart2_logistic_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c1"># 예측의 정확성 계산</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy: </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_A</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>위의 결과에서 본 것처럼 독립적인 검증 데이터로 구한 예측의 정확성이 동일한 학습데이터로 부터 구한 예측의 정확성보다 일반적으로  작게 나타난다.</p>
<p>다시 강조하면 독립적인 검증 데이터로 구한 예측의 정확성이 더 정확한 측도이다.</p>
</section>
<section id="id8">
<h2><span class="section-number">8.4.7. </span>기계학습 방법의 평가<a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h2>
<p>이제 앞 절에서 다룬 4개의 기계학습 모형들을 이용하여 심장병 예측에 대한 예측의 정확도를 비교해 보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 기계학습 모형의 정의</span>
<span class="n">model_logistic</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">model_tree</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">model_knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">model_svm</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s2">&quot;rbf&quot;</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 모형의 적합</span>
<span class="n">model_logistic</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">model_tree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">model_knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">model_svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_accuracy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Logisitc&quot;</span><span class="p">,</span><span class="s2">&quot;Decision Tree&quot;</span><span class="p">,</span> <span class="s2">&quot;KNN&quot;</span><span class="p">,</span> <span class="s2">&quot;Kernel SVM&quot;</span><span class="p">],</span> <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">4</span><span class="p">)})</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">clf</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span> <span class="n">model_logistic</span><span class="p">,</span> <span class="n">model_tree</span><span class="p">,</span> <span class="n">model_knn</span><span class="p">,</span> <span class="n">model_svm</span><span class="p">]):</span>

    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">df_accuracy</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    
<span class="n">df_accuracy</span>    
</pre></div>
</div>
</div>
</div>
<p>위의 결과를 보면 서포트 벡터 머신이 가장 좋은 예측의 정확도를 보인다.</p>
</section>
<section id="id9">
<h2><span class="section-number">8.4.8. </span>정리<a class="headerlink" href="#id9" title="Permalink to this headline">#</a></h2>
<p>분류에서 예측을 하는 절차를 정리하면 다음과 같다.</p>
<ol class="simple">
<li><p>데이터의 전처리</p></li>
</ol>
<ul class="simple">
<li><p>반응변수를 1과 0으로 코딩</p></li>
<li><p>연속형 설명변수를 표준화</p></li>
<li><p>범주형 설병변수에 대한 가변수 생성</p></li>
<li><p>데이터를 학습데이터와 검증데이터로 분리 (<code class="docutils literal notranslate"><span class="pre">X_train,</span> <span class="pre">X_test,</span> <span class="pre">y_train,</span> <span class="pre">y_test</span></code>)</p></li>
</ul>
<ol class="simple">
<li><p>예측 모형의 정의</p></li>
</ol>
<ul class="simple">
<li><p>예:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
</pre></div>
</div>
<ol class="simple">
<li><p>학습 데이터를 이용한 모형의 적합</p></li>
</ol>
<ul class="simple">
<li><p>예:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
<ol class="simple">
<li><p>검증 데이터를 이용한 모형의 평가</p></li>
</ol>
<ul class="simple">
<li><p>예측의 정확도 계산</p></li>
<li><p>예:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters/08"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="classification.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">8.3. </span>분류와 예측모형</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By 서울시립대학교<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>