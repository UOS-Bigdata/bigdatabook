
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>8.3. 분류와 예측모형 &#8212; 빅데이터 개론 2</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystyle.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="8.4. 분류의 평가" href="validation.html" />
    <link rel="prev" title="8.2. 선형 회귀모형" href="regression.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">빅데이터 개론 2</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    빅데이터 개론 2
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01/intro-course.html">
   1. 서론
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/intro-program.html">
     1.1. 프로그래밍 언어
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/intro-stat.html">
     1.2. 통계학
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02/intro-python.html">
   2. 파이선의 기초
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/basic-expression.html">
     2.1. 표현식과 변수
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/data-processing-intro.html">
     2.2. 데이터의 처리
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/data-processing-train-passenger.html">
     2.3. 고속열차 여객 수송자료
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/data-processing-text.html">
     2.4. 어린 왕자
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03/types.html">
   3. 자료의 형식
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/numbers.html">
     3.1. 숫자
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/string.html">
     3.2. 문자열
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/array.html">
     3.3. 행렬
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../04/dataframe.html">
   4. 데이터프레임
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../04/dataframe-intro.html">
     4.1. 데이터프레임의 정의와 구성요소
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04/dataframe-change.html">
     4.2. 데이터프레임의 정리
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04/dataframe-summary.html">
     4.3. 데이터프레임의 요약
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04/dataframe-merge.html">
     4.4. 데이터프레임의 결합
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../05/data-intro.html">
   5. 분포와 확률
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/data_distribution.html">
     5.1. 자료의 분포
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/data_randomness.html">
     5.2. 분포와 우연성
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/data_random_experiment.html">
     5.3. 확률과 컴퓨터 실험
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/data_probability.html">
     5.4. 확률의 기초
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/data_function.html">
     5.5. 함수
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../06/sampling-intro.html">
   6. 표본과 경험적 분포
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/sample.html">
     6.1. 표본과 정보
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/samplemeans.html">
     6.2. 통계량의 분포
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/estimator.html">
     6.3. 추정량의 성질
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/bootstrap.html">
     6.4. 붓스트랩
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../07/test-intro.html">
   7. 유의성 검정
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../07/decision.html">
     7.1. 선택과 증거
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07/pvalue.html">
     7.2. 유의성 검정
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07/abtest.html">
     7.3. 두 그룹의 비교
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="relation-intro.html">
   8. 관계와 예측
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="correlation.html">
     8.1. 두 변수의 관계
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="regression.html">
     8.2. 선형 회귀모형
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     8.3. 분류와 예측모형
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="validation.html">
     8.4. 분류의 평가
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/UOS-Bigdata/bigdatabook/master?urlpath=tree/chapters/08/classification.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/UOS-Bigdata/bigdatabook/blob/master/chapters/08/classification.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/UOS-Bigdata/bigdatabook"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/chapters/08/classification.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   8.3.1. 분류
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   8.3.2. 데이터의 구조와 전처리
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     8.3.2.1. 예제: 잔디 제초 트랙터
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     8.3.2.2. 데이터 전처리
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     8.3.2.3. 학습과 예측 데이터의 분리
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   8.3.3. 로지스틱 회귀모형
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     8.3.3.1. 로지스틱 회귀모형의 정의
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     8.3.3.2. 분류 경계선
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     8.3.3.3. 모형의 적합
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     8.3.3.4. 분류를 위한 예측
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id12">
   8.3.4. 기계학습 모형
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>분류와 예측모형</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   8.3.1. 분류
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   8.3.2. 데이터의 구조와 전처리
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     8.3.2.1. 예제: 잔디 제초 트랙터
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     8.3.2.2. 데이터 전처리
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     8.3.2.3. 학습과 예측 데이터의 분리
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id7">
   8.3.3. 로지스틱 회귀모형
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     8.3.3.1. 로지스틱 회귀모형의 정의
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     8.3.3.2. 분류 경계선
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     8.3.3.3. 모형의 적합
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     8.3.3.4. 분류를 위한 예측
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id12">
   8.3.4. 기계학습 모형
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1><span class="section-number">8.3. </span>분류와 예측모형<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h1>
<p>필요한 패키지와 라이브러리 설치하고 사용할 함수를 먼저 정의한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 한글 폰트가 깨질 때 사용 - 런타임 메뉴에서 다시 시작 및 모두 실행 선택. (출처: https://teddylee777.github.io/colab/colab-korean)</span>
<span class="o">!</span>sudo apt-get install -y fonts-nanum
<span class="o">!</span>sudo fc-cache -fv
<span class="o">!</span>rm ~/.cache/matplotlib -rf
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Reading package lists... Done
Building dependency tree       
Reading state information... Done
fonts-nanum is already the newest version (20170925-1).
0 upgraded, 0 newly installed, 0 to remove and 37 not upgraded.
/usr/share/fonts: caching, new cache contents: 0 fonts, 1 dirs
/usr/share/fonts/truetype: caching, new cache contents: 0 fonts, 3 dirs
/usr/share/fonts/truetype/humor-sans: caching, new cache contents: 1 fonts, 0 dirs
/usr/share/fonts/truetype/liberation: caching, new cache contents: 16 fonts, 0 dirs
/usr/share/fonts/truetype/nanum: caching, new cache contents: 10 fonts, 0 dirs
/usr/local/share/fonts: caching, new cache contents: 0 fonts, 0 dirs
/root/.local/share/fonts: skipping, no such directory
/root/.fonts: skipping, no such directory
/var/cache/fontconfig: cleaning cache directory
/root/.cache/fontconfig: not cleaning non-existent cache directory
/root/.fontconfig: not cleaning non-existent cache directory
fc-cache: succeeded
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pandas 라이브러리의 탐색적 데이터 분석 도구(explanatory data analysis tool, profiling)를 설치한다.</span>
<span class="o">!</span>pip install -U pandas-profiling
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pandas-profiling in /usr/local/lib/python3.7/dist-packages (3.1.0)
Requirement already satisfied: markupsafe~=2.0.1 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling) (2.0.1)
Requirement already satisfied: phik&gt;=0.11.1 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling) (0.12.0)
Requirement already satisfied: requests&gt;=2.24.0 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling) (2.26.0)
Requirement already satisfied: pydantic&gt;=1.8.1 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling) (1.8.2)
Requirement already satisfied: pandas!=1.0.0,!=1.0.1,!=1.0.2,!=1.1.0,&gt;=0.25.3 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling) (1.1.5)
Requirement already satisfied: multimethod&gt;=1.4 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling) (1.6)
Requirement already satisfied: htmlmin&gt;=0.1.12 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling) (0.1.12)
Requirement already satisfied: jinja2&gt;=2.11.1 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling) (2.11.3)
Requirement already satisfied: tqdm&gt;=4.48.2 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling) (4.62.3)
Requirement already satisfied: PyYAML&gt;=5.0.0 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling) (6.0)
Requirement already satisfied: seaborn&gt;=0.10.1 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling) (0.11.2)
Requirement already satisfied: joblib~=1.0.1 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling) (1.0.1)
Requirement already satisfied: matplotlib&gt;=3.2.0 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling) (3.2.2)
Requirement already satisfied: tangled-up-in-unicode==0.1.0 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling) (0.1.0)
Requirement already satisfied: scipy&gt;=1.4.1 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling) (1.7.3)
Requirement already satisfied: numpy&gt;=1.16.0 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling) (1.19.5)
Requirement already satisfied: missingno&gt;=0.4.2 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling) (0.5.0)
Requirement already satisfied: visions[type_image_path]==0.7.4 in /usr/local/lib/python3.7/dist-packages (from pandas-profiling) (0.7.4)
Requirement already satisfied: networkx&gt;=2.4 in /usr/local/lib/python3.7/dist-packages (from visions[type_image_path]==0.7.4-&gt;pandas-profiling) (2.6.3)
Requirement already satisfied: attrs&gt;=19.3.0 in /usr/local/lib/python3.7/dist-packages (from visions[type_image_path]==0.7.4-&gt;pandas-profiling) (21.2.0)
Requirement already satisfied: Pillow in /usr/local/lib/python3.7/dist-packages (from visions[type_image_path]==0.7.4-&gt;pandas-profiling) (7.1.2)
Requirement already satisfied: imagehash in /usr/local/lib/python3.7/dist-packages (from visions[type_image_path]==0.7.4-&gt;pandas-profiling) (4.2.1)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=3.2.0-&gt;pandas-profiling) (1.3.2)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=3.2.0-&gt;pandas-profiling) (0.11.0)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=3.2.0-&gt;pandas-profiling) (3.0.6)
Requirement already satisfied: python-dateutil&gt;=2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib&gt;=3.2.0-&gt;pandas-profiling) (2.8.2)
Requirement already satisfied: pytz&gt;=2017.2 in /usr/local/lib/python3.7/dist-packages (from pandas!=1.0.0,!=1.0.1,!=1.0.2,!=1.1.0,&gt;=0.25.3-&gt;pandas-profiling) (2018.9)
Requirement already satisfied: typing-extensions&gt;=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from pydantic&gt;=1.8.1-&gt;pandas-profiling) (3.10.0.2)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&gt;=2.1-&gt;matplotlib&gt;=3.2.0-&gt;pandas-profiling) (1.15.0)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.24.0-&gt;pandas-profiling) (1.24.3)
Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.24.0-&gt;pandas-profiling) (2.0.8)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.24.0-&gt;pandas-profiling) (2021.10.8)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.24.0-&gt;pandas-profiling) (2.10)
Requirement already satisfied: PyWavelets in /usr/local/lib/python3.7/dist-packages (from imagehash-&gt;visions[type_image_path]==0.7.4-&gt;pandas-profiling) (1.2.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pandas_profiling</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;NanumBarunGothic&#39;</span><span class="p">)</span> <span class="c1"># clolab 에서 한글 사용 </span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.unicode_minus&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>   <span class="c1"># 그림 크기 조정</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#기계학습 모형</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">tree</span>

<span class="c1"># 기계학습 평가 도구</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">f1_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 표준화 함수</span>
<span class="k">def</span> <span class="nf">standarize</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h2><span class="section-number">8.3.1. </span>분류<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<p>앞 절에서는 반응변수 <span class="math notranslate nohighlight">\(y\)</span> 가 연속형 변수인 경우 설명변수 <span class="math notranslate nohighlight">\(x\)</span> 에 따라서 반응변수의 평균을 예측하는 선형 회귀 모형을 배웠다. 앞 절에서 배운 선형 회귀모형은 예측 모형 중에서 가장 단순한 모형이며 다음과 같은 경우로 확장할 수 있다.</p>
<ul class="simple">
<li><p>설명변수가 2개 이상인 경우</p></li>
<li><p><span class="math notranslate nohighlight">\(E(y|x)\)</span> 가 비선형(nonlinear) 인 경우</p></li>
</ul>
<p>이제 이 절에서는 반응변수가 연속형이 아닌 범주형 변수인 경우를 고려할 것이다. 반응 변수가 범주형인 경우 예측하는 경우를 우리는 <strong>분류(classification)</strong> 이라고 부른다. 이  절에서는 <strong>2개의 가능한 경우를 가지는 범주형 변수, 즉 이항 변수(binary variable)을 예측</strong> 하는 경우에 대하여 알아보고자 한다.</p>
<p>앞에서 가설 검정을 배울 때 강조한 것처럼 우리는 살아가면서 수많은 결정을 내린다. 대부분의 결정은 가능한 두 개의 선택 중에 하나를 선택하는 것이다. 여러분의 결정은 주어진 상황에 대하여  경험과 지식을 기반으로 이루어 진다. 즉, 인간은 배운 지식과 습득한 경험을 기반으로 결정을 내리는 것이다. 이러하 인간의 결정하는 절차를 데이터를 기반으로 하여 통계적 방법과 컴퓨터 알고리즘을 이용하여 구현하는 것은 <strong>기계 학습(machine learning)</strong> 또는 <strong>인공 지능(artificial intelligence)</strong> 라고 부른다. 최근에 활발하게 사용되는  딥러닝(deep learning)도 인간의 결정 과정을 더욱 정교하게 구현한 예측 방법이다.</p>
<p>이제 분류에 사용되는 기계학습 방법 중에 대표적인 몇 가지 예측 방법들의 개념과 구현 방법을 간단한 예제들을 통해서 알아보고자 한다.</p>
</section>
<section id="id3">
<h2><span class="section-number">8.3.2. </span>데이터의 구조와 전처리<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h2>
<section id="id4">
<h3><span class="section-number">8.3.2.1. </span>예제: 잔디 제초 트랙터<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<p>여러분이 아파트가 아닌 마당이 있는 단독주택을 구입하고 싶디면 푸른 잔디가 있는 넓은 정원이 있는 것이 좋을 것이다. 하지만 여러분이 이런 넓은 정원이 있는 주택에 산다면 누군가는 정원을 돌봐야 하고 잔디를 주기적을 깍아주어야 한다.</p>
<p>미국의 한 기업은 앉아서 운전하는 잔디를 제초할 수 있는 트랙터(lawn mower)를 생산하고 있다. 넓은 대지를 가진 주택을 소유하고 있는 사람들이 제초 트랙터를 살 가능성이 높을 것이라는 것은 예상하기 쉽다. 또한 넓은 정원을 가진 사람들은 소득도 일반적으로 높을 것이라고 예상할 수 있다.</p>
<p>이 기업의 마케팅 부서에서는 제초 트랙터를 살 가능성이 높은 사람들에게  홍보를 하려고 한다. 제품 홍보의 대상이 되는 사람들을 선택하기 위하여 실제 데이터를 수집하였다. 수집한 데이터는 다음과 같은 3개의 변수로 구성되어 있다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lotsize</span></code>: 주택의 대지 변적 (단위: 1,000 square feet)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">income</span></code> : 연소득 (단위: $1,000)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">class</span></code> : 제초 트랙터의 보유 여부( 1=보유 , 2=미보유)</p></li>
</ul>
<p>이제 데이터를 외부화일에서 읽어서 데이터프레임 <code class="docutils literal notranslate"><span class="pre">lawn_mower_0</span></code> 에 저장하자. 데이터프레임 <code class="docutils literal notranslate"><span class="pre">lawn_mower_0</span></code>는 모두 24개 레코드로 구성되어 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url1</span> <span class="o">=</span> <span class="s2">&quot;https://ilovedata.github.io/teaching/bigdata2/data/lawn-mower.txt&quot;</span>
<span class="n">lawn_mower_0</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url1</span><span class="p">,</span> <span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lawn_mower_0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>income</th>
      <th>lotsize</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>60.0</td>
      <td>18.4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>85.5</td>
      <td>16.8</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>64.8</td>
      <td>21.6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>61.5</td>
      <td>20.8</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>87.0</td>
      <td>23.6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>110.1</td>
      <td>19.2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>108.0</td>
      <td>17.6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>82.8</td>
      <td>22.4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>69.0</td>
      <td>20.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>93.0</td>
      <td>20.8</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>51.0</td>
      <td>22.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>11</th>
      <td>81.0</td>
      <td>20.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>12</th>
      <td>75.0</td>
      <td>19.6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>13</th>
      <td>52.8</td>
      <td>20.8</td>
      <td>2</td>
    </tr>
    <tr>
      <th>14</th>
      <td>64.8</td>
      <td>17.2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>15</th>
      <td>43.2</td>
      <td>20.4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>16</th>
      <td>84.0</td>
      <td>17.6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>17</th>
      <td>49.2</td>
      <td>17.6</td>
      <td>2</td>
    </tr>
    <tr>
      <th>18</th>
      <td>59.4</td>
      <td>16.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19</th>
      <td>66.0</td>
      <td>18.4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>20</th>
      <td>47.4</td>
      <td>16.4</td>
      <td>2</td>
    </tr>
    <tr>
      <th>21</th>
      <td>33.0</td>
      <td>18.8</td>
      <td>2</td>
    </tr>
    <tr>
      <th>22</th>
      <td>51.0</td>
      <td>14.0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>23</th>
      <td>63.0</td>
      <td>14.8</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>마케팅 부서의 목적은 무었인가? 만약 어떤 사람이 거주하는 주택의 대지 면적과 소득을 알았을 때 이 사람이 제초 트랙터를 구입할 가능성을 예측하고 싶은 것이다.</p>
<p>구입할 가능성이 크다면 더 적극적인 방법으로 홍보를 할 것이다. 이렇게 고객들을 제초 트랙터를 구입할 가능성이 높은 사람과 낮은 사람으로 잘 분류할 수 있다면 회사는 효율적인 마케팅을 수행할 수 있다.</p>
<p>아래 산점도는 데이터에서 주택의 대지 면적과 연소득에 대하여  제초 트랙터의 보유 여부를 나타낸 것이다.
예측한 대로 대지의 면적이 클수록, 그리도 연소득이 높을수록 제초 트랙터를 구입할 가능성이 높다.</p>
<p>만약 새로운 고객의 연소득이 <code class="docutils literal notranslate"><span class="pre">income=70</span></code> 이고  주택의대지 면적이 <code class="docutils literal notranslate"><span class="pre">lotsize=19</span></code>이라면 (아래 그림의 빨간점) 마케팅 직원은 이 고객을 어떻게 분류해야 하는가? 새로운 고객은 제초 트랙터를 구입할 가능성이 높은가?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">lawn_mower_0</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span> <span class="s2">&quot;income&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span> <span class="s2">&quot;lotsize&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;deep&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7ff2e06bf450&gt;
</pre></div>
</div>
<img alt="../../_images/classification_13_1.png" src="../../_images/classification_13_1.png" />
</div>
</div>
</section>
<section id="id5">
<h3><span class="section-number">8.3.2.2. </span>데이터 전처리<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h3>
<p>분류에서는 일반적으로  2개의 가능한 선택을 성공(success)와 실패(failure)라고 구분한다.</p>
<p>예를 들어서 고객이  제초 트랙터를 구입하는 사건을 성공, 구입하지 않으면 실패라고 할 수 있다. 성공과 실패는 문제에 따라서 적절하게 정의한다.</p>
<p>반응변수 <span class="math notranslate nohighlight">\(y\)</span>를 다음과 같이 성공이면 1, 실패면 0으로 정의하자. 이렇게 2개의 가능한 범주를 가지는 변수를 이항변수(binary variable)라고부른다.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
y = \begin{cases}
0 &amp; \text{ if failure }\\
1 &amp; \text{ if success} 
\end{cases}
\end{equation}
\end{split}\]</div>
<p>이제 데이터프레임에서  위에서 정의한 대로 반응변수의 값을 성공과 실패에 따라서 1과 0으로 바꾼다.</p>
<p>기계학습 방법을 사용하는 경우 데이터에서 반응변수의 값을 0과 1로 코딩하는 것이 일반적이고 통상적이 절차이다. 우리가 사용하는  라이브러리 <code class="docutils literal notranslate"><span class="pre">SKlearn</span></code> 도 이러한 규칙을 따른다.</p>
<p>또한 연속형 설명변수들은 모두 표준화 하는 것이 여러 가지 예측 모형을 적용할 때 필요하다.</p>
<p>기계학습 모형을 사용하고자 할 때 다음과 같은 전처리를 반드시 해주는 것이 좋다.</p>
<ul class="simple">
<li><p><strong>반응변수를 0 과 1로 코딩한다.</strong></p></li>
<li><p><strong>연속형 설명변수는 표준화한다.</strong></p></li>
</ul>
<p>또한 앞에서 언급한 새로운 고객의 연소득과 대지 면적을 대이터프레임 <code class="docutils literal notranslate"><span class="pre">lawn_mower</span></code>에 추가하자.  새로운 고객의 제품 구입의 여부는 알 수 없고 예측해야 하는 목표이다. 따라서 구입 여부는 결측값(missing) <code class="docutils literal notranslate"><span class="pre">np.NaN</span></code> 으로 입력한다.</p>
<p>이제 데이터프레임 <code class="docutils literal notranslate"><span class="pre">lawn_mower</span></code> 의 변수들을 표준화하고 재코딩하자. 반응변수의 열이름을 <code class="docutils literal notranslate"><span class="pre">buy</span></code>로 변환한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 새로운 고객 자료</span>
<span class="n">new_customer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;income&#39;</span><span class="p">:[</span><span class="mi">70</span><span class="p">],</span> <span class="s1">&#39;lotsize&#39;</span><span class="p">:[</span><span class="mi">19</span><span class="p">],</span> <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">]})</span>
<span class="c1"># 조사한 데이터프레임에 새로운 고객자료 추가</span>
<span class="n">lawn_mower_0</span> <span class="o">=</span> <span class="n">lawn_mower_0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">new_customer</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">lawn_mower_0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>income</th>
      <th>lotsize</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>60.0</td>
      <td>18.4</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>85.5</td>
      <td>16.8</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>64.8</td>
      <td>21.6</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>61.5</td>
      <td>20.8</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>87.0</td>
      <td>23.6</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>110.1</td>
      <td>19.2</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>108.0</td>
      <td>17.6</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>82.8</td>
      <td>22.4</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>69.0</td>
      <td>20.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>93.0</td>
      <td>20.8</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>51.0</td>
      <td>22.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>81.0</td>
      <td>20.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>75.0</td>
      <td>19.6</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>52.8</td>
      <td>20.8</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>64.8</td>
      <td>17.2</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>43.2</td>
      <td>20.4</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>84.0</td>
      <td>17.6</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>49.2</td>
      <td>17.6</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>59.4</td>
      <td>16.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>66.0</td>
      <td>18.4</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>47.4</td>
      <td>16.4</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>33.0</td>
      <td>18.8</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>51.0</td>
      <td>14.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>63.0</td>
      <td>14.8</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>70.0</td>
      <td>19.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 데이터프레임 복사본 생성</span>
<span class="n">lawn_mower</span> <span class="o">=</span> <span class="n">lawn_mower_0</span>
<span class="c1"># 새로운 반응변수 buy 를 정의 (0과 1)</span>
<span class="n">lawn_mower</span><span class="p">[</span><span class="s1">&#39;buy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">-</span> <span class="n">lawn_mower</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span>
<span class="c1"># 원래 반응변수 열 class 삭제</span>
<span class="n">lawn_mower</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># 독립변수 표준화</span>
<span class="n">lawn_mower</span><span class="p">[</span><span class="s1">&#39;income&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">standarize</span><span class="p">(</span><span class="n">lawn_mower</span><span class="o">.</span><span class="n">income</span><span class="p">)</span>
<span class="n">lawn_mower</span><span class="p">[</span><span class="s1">&#39;lotsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">standarize</span><span class="p">(</span><span class="n">lawn_mower</span><span class="o">.</span><span class="n">lotsize</span><span class="p">)</span>

<span class="n">lawn_mower</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>income</th>
      <th>lotsize</th>
      <th>buy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.447666</td>
      <td>-0.236997</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.895331</td>
      <td>-0.923946</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.194866</td>
      <td>1.136900</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.368666</td>
      <td>0.793426</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.974331</td>
      <td>1.995586</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.190928</td>
      <td>0.106477</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2.080329</td>
      <td>-0.580472</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.753132</td>
      <td>1.480374</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.026333</td>
      <td>0.449951</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.290330</td>
      <td>0.793426</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>-0.921665</td>
      <td>1.308637</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.658332</td>
      <td>0.449951</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.342333</td>
      <td>0.278214</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>-0.826865</td>
      <td>0.793426</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>-0.194866</td>
      <td>-0.752209</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>-1.332464</td>
      <td>0.621689</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.816331</td>
      <td>-0.580472</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>-1.016464</td>
      <td>-0.580472</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>-0.479266</td>
      <td>-1.267420</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>-0.131666</td>
      <td>-0.236997</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>-1.111264</td>
      <td>-1.095683</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>-1.869662</td>
      <td>-0.065260</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>-0.921665</td>
      <td>-2.126106</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>-0.289666</td>
      <td>-1.782632</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>0.079000</td>
      <td>0.020608</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="id6">
<h3><span class="section-number">8.3.2.3. </span>학습과 예측 데이터의 분리<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h3>
<p>위에서 만든 데이타프레임 <code class="docutils literal notranslate"><span class="pre">lwan_mower</span></code> 에는 반응변수의 결과가 있는 자료와 새로 예측할 자료가 같이 포함되어 있다. 설면변수를 표준화를 하기 위하여  새로 예측할 자료를 원자료에 포람시켜 준 것이다.</p>
<p>우리는 이제 반응변수의 결과가 있는 원래 자료를 이용하여  예측 모형을 학습시킬 것이다.  <strong>반응변수의 결과가 포함된 자료를 학습 데이터(training data) 라고 한다.</strong></p>
<p>또한 우리가 예측하고자 하는 새로운 고객에 대한 자료는 반응변수의 값이 없는 데이터이다. <strong>이렇게 예측을 하려고 하는 데이터를 검증 데이터(test data, validation data)</strong> 라고 한다.</p>
<p>학습데이터와 검증 데이터를 분리한 후 설명변수와 반응변수를 다시 분리하여 <code class="docutils literal notranslate"><span class="pre">numpy</span></code> 행렬 형식으로 저장해야 한다.</p>
<p>이제 다음과 같이 학습 데이터와 검증 데이터를  설명변수와 반응변수로 나누어 저장하자.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">X_train</span></code>: 학습 데이터의 셜명변수 값이 포함된 <code class="docutils literal notranslate"><span class="pre">numpy</span></code> 행렬</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y_train</span></code>: 학습 데이터의 반응변수 값이 포함된 <code class="docutils literal notranslate"><span class="pre">numpy</span></code> 행렬</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">X_predict</span></code>: 검증 데이터의 셜명변수 값이 포함된 <code class="docutils literal notranslate"><span class="pre">numpy</span></code> 행렬</p></li>
</ul>
<p>아래 코드에서 <code class="docutils literal notranslate"><span class="pre">isnull()</span></code> 은 결측값이 존재하는지 확인하는 메소드이다. 결측값이 있는 경우 <code class="docutils literal notranslate"><span class="pre">True</span></code>, 아니면 <code class="docutils literal notranslate"><span class="pre">False</span></code> 를 생성한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span> <span class="n">lawn_mower</span><span class="o">.</span><span class="n">buy</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     False
1     False
2     False
3     False
4     False
5     False
6     False
7     False
8     False
9     False
10    False
11    False
12    False
13    False
14    False
15    False
16    False
17    False
18    False
19    False
20    False
21    False
22    False
23    False
24     True
Name: buy, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 학습데이터 - 설명변수</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lawn_mower</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">lawn_mower</span><span class="o">.</span><span class="n">buy</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;buy&#39;</span><span class="p">))</span>
<span class="c1"># 학습데이터 - 반응변수</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lawn_mower</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">lawn_mower</span><span class="o">.</span><span class="n">buy</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="s1">&#39;buy&#39;</span><span class="p">])</span>
<span class="c1"># 예측데이터 - 설명변수</span>
<span class="n">X_predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lawn_mower</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">lawn_mower</span><span class="o">.</span><span class="n">buy</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;buy&#39;</span><span class="p">))</span>

<span class="n">y_train</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0.])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id7">
<h2><span class="section-number">8.3.3. </span>로지스틱 회귀모형<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h2>
<p>이제 잔디 제초 트랙터 데이터를 이용하여 분류를 수행하는 검증모형을 만들려고 한다.</p>
<p>여러분이 아래 산점도에 주어진 데이터를 보고 새로운 고객(<code class="docutils literal notranslate"><span class="pre">income=70</span></code>, <code class="docutils literal notranslate"><span class="pre">lotsize=19</span></code>) 을 어떻게 분류하겠는가?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">lawn_mower</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span> <span class="s2">&quot;income&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span> <span class="s2">&quot;lotsize&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;buy&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;deep&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.079000</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.020608</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7ff2df6f4050&gt;
</pre></div>
</div>
<img alt="../../_images/classification_21_1.png" src="../../_images/classification_21_1.png" />
</div>
</div>
<section id="id8">
<h3><span class="section-number">8.3.3.1. </span>로지스틱 회귀모형의 정의<a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h3>
<p>여러분은 위의 산점도에서  연소득이 많아질수록 그리고 주택의 대지 면적이 증가할수록 제초 트랙터를 구입할 가능성이 높아짐을 알 수 있다.</p>
<p>우리는 앞에서 임의의 사건이 일어날 가능성을 확률로 수치화하는 것을 배웠다. 이러한 개념을 적용하면
다음과 같이 데이터의 산점도가 주는 정보를 요약할 수 있다.</p>
<ul class="simple">
<li><p><strong>연소득이 많아질수록 그리고 주택의 대지 면적이 증가할수록 제초 트랙터를 구입할 확률이 높아진다</strong></p></li>
</ul>
<p>연소득을 <span class="math notranslate nohighlight">\(x_1\)</span>,주택의 대지 면적을 <span class="math notranslate nohighlight">\(x_2\)</span> 라고 하고 제초 트랙터를 구입하는 사건(성공)을 <span class="math notranslate nohighlight">\(y=1\)</span> 이라고 하면 위의 문구를 다음과 같은 관계식으로 나타낼 수 있다.</p>
<div class="math notranslate nohighlight">
\[ P(y=1 | x_1, x_2 ) \propto x_1 \quad \text{and} \quad  P(y=1 | x_1, x_2 ) \propto x_2  \]</div>
<p>위의 관계를 다음과 같이 나타내는 기계학습 모형을 <strong>로지스틱 회귀모형(logistic regression model)</strong> 이라고 한다.</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\begin{align}
P(y=1 | x_1, x_2 )  &amp; = \frac{ \exp(\beta_0 + \beta_1 x_1 + \beta_2 x_2)}{1+ \exp(\beta_0 + \beta_1 x_1 + \beta_2 x_2)}  \\ 
 &amp; = \frac{1}{1+ \exp(-[\beta_0 + \beta_1 x_1 + \beta_2 x_2])}
\end{align}
\end{split}\]</div>
<p>위의 회귀 모형식에서 만약에 회귀 계수(regression coefficient) <span class="math notranslate nohighlight">\(\beta_1\)</span>과 <span class="math notranslate nohighlight">\(\beta_2\)</span> 가 양수이면 제초 트랙터를 구입히는 사건에 대한 확률은 연소득, 주택의 대지 면적과 비선형적으로 비례적관계를 가진다.</p>
<p>위에서 주어진 로지스틱 회귀모형에서 주어진 독립변수의 값 <span class="math notranslate nohighlight">\(x_1\)</span> 과 <span class="math notranslate nohighlight">\(x_2\)</span> 에서 계산된 성공의 확률 <span class="math notranslate nohighlight">\(P(y=1|x_1,x_2)\)</span> 가 0.5 보다 크면 성공(<span class="math notranslate nohighlight">\(\hat y=1\)</span>)이라고 예측하고 0.5보다 작으면 실패(<span class="math notranslate nohighlight">\(\hat y=0\)</span>)라고 예측한다.</p>
<ul class="simple">
<li><p><strong>만약 <span class="math notranslate nohighlight">\(P(y=1| x_1, x_2) &gt; 0.5\)</span> 이면 성공 <span class="math notranslate nohighlight">\(\hat y=1\)</span> 으로 예측한다.</strong></p></li>
<li><p><strong>만약 <span class="math notranslate nohighlight">\(P(y=1| x_1, x_2) &lt; 0.5\)</span> 이면 실패 <span class="math notranslate nohighlight">\(\hat y=0\)</span> 로 예측한다.</strong></p></li>
</ul>
</section>
<section id="id9">
<h3><span class="section-number">8.3.3.2. </span>분류 경계선<a class="headerlink" href="#id9" title="Permalink to this headline">#</a></h3>
<p>로지스틱 회귀모형에서 추정된 확률 <span class="math notranslate nohighlight">\(P(y|x_1, x_2)\)</span> 이 0.5 가 되는 독립변수들의 집합을 <strong>분류 경계선 (Decision boundary)</strong> 라고 부른다.</p>
<div class="math notranslate nohighlight">
\[ \text{Decision boundary} = \{ x_1, x_2 | P(y|x_1, x_2) = 0.5 \} \]</div>
<p>가장 간단한 예로 하나의 독립변수 <span class="math notranslate nohighlight">\(x_1\)</span> 만 고려한 로지스틱 회귀모형은 다음과 같고 함수관계를 그리면 다음 그림과 같이 나타난다.</p>
<div class="math notranslate nohighlight">
\[ P(y=1 | x_1) = \frac{ \exp(\beta_0 + \beta_1 x_1 )}{1+ \exp(\beta_0 + \beta_1 x_1 )}  = \frac{ 1}{1+ \exp(-[\beta_0 + \beta_1 x_1] )}\]</div>
<p>아래 그림의 수평선은 확률이 0.5인 선이고 수직선이 바로 분류 경계선이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">logistic_curve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">beta0</span><span class="p">,</span> <span class="n">beta1</span><span class="p">):</span>
  <span class="n">p</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">beta0</span> <span class="o">-</span><span class="n">beta1</span><span class="o">*</span><span class="n">x</span><span class="p">))</span> 
  <span class="k">return</span> <span class="n">p</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">b0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">b1</span> <span class="o">=</span> <span class="mf">3.0</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">logistic_curve</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">b0</span><span class="p">,</span><span class="n">b1</span><span class="p">)</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/classification_24_0.png" src="../../_images/classification_24_0.png" />
</div>
</div>
</section>
<section id="id10">
<h3><span class="section-number">8.3.3.3. </span>모형의 적합<a class="headerlink" href="#id10" title="Permalink to this headline">#</a></h3>
<p>이제 두 개의 독립변수와 반응변수의 값이 포함된 학습 데이터를 이용하여 로지스틱 회귀모형을 적합해보자.</p>
<p>먼저 <code class="docutils literal notranslate"><span class="pre">SKlearn</span></code> 라이브러리의 <code class="docutils literal notranslate"><span class="pre">LogisticRegression()</span></code> 를 이용하여 로지스틱 회귀모형을 정의한다. 다음으로 <code class="docutils literal notranslate"><span class="pre">fit()</span></code> 메소드에  학습데이터 <code class="docutils literal notranslate"><span class="pre">X_train</span></code> 와  <code class="docutils literal notranslate"><span class="pre">y_train</span></code> 를 인자로 입력하여 모형의 계수
<span class="math notranslate nohighlight">\(\beta_0\)</span>, <span class="math notranslate nohighlight">\(\beta_1\)</span>, <span class="math notranslate nohighlight">\(\beta_2\)</span> 를 추정한다.</p>
<p>추정의 결과는 <code class="docutils literal notranslate"><span class="pre">lawn_logistic_fit</span></code> 에 저장한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lawn_logistic_fit</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">lawn_logistic_fit</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LogisticRegression()
</pre></div>
</div>
</div>
</div>
<p>이제 계수의 추정값 <span class="math notranslate nohighlight">\(\hat \beta_0\)</span>, <span class="math notranslate nohighlight">\(\hat \beta_1\)</span>, <span class="math notranslate nohighlight">\(\hat \beta_2\)</span> 를 구해보자.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">intercept_[0]</span></code> 메소드: 절편의 추정값</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coef_.T</span></code>: 기울기 계수의 추정값 벡터</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># beta0</span>
<span class="n">b0</span> <span class="o">=</span> <span class="n">lawn_logistic_fit</span><span class="o">.</span><span class="n">intercept_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># beta1, beta2 </span>
<span class="n">b1</span><span class="p">,</span> <span class="n">b2</span> <span class="o">=</span> <span class="n">lawn_logistic_fit</span><span class="o">.</span><span class="n">coef_</span><span class="o">.</span><span class="n">T</span>

<span class="n">b0</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">b2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.006771974798307603, array([1.15076653]), array([1.18178588]))
</pre></div>
</div>
</div>
</div>
<p>이제 위에서 추정된 계수를 이용하여 성공 확률의 예측식을 다음과 같이 나타낼 수 있다.</p>
<div class="math notranslate nohighlight">
\[\begin{split} 
\begin{align}
P(y=1 | x_1, x_2 )  &amp; = \frac{ 1}
{1+ \exp(-[\beta_0 + \beta_1 x_1 + \beta_2 x_2] )} \\ 
&amp; =  \frac{ 1}{1+ \exp[0.00678 - (1.1508) x_1 - (1.1818) x_2]} 
\end{align}
\end{split}\]</div>
<p>또한 분류 경계선을 다음과 같이 나타낼 수 있다.</p>
<div class="math notranslate nohighlight">
\[  \frac{ 1}{1+ \exp[0.00678 - (1.1508) x_1 - (1.1818) x_2]}  = 0.5 \]</div>
<p>아래 그림에서 점선으로 나타난 분류 경계선의 위쪽 부분은 예측 확률 <span class="math notranslate nohighlight">\(E(y=1|x_1,x_2)\)</span> 가 0.5 보다 크므로 성공(<span class="math notranslate nohighlight">\(\hat y =1\)</span>)이라고 예측한다.
반대로  경계선의 아래쪽 부분은 예측 확률 <span class="math notranslate nohighlight">\(E(y=1|x_1,x_2)\)</span> 가 0.5 보다 작으므로 실패라고 예측한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 분류 경계선을의 절편과 기울기 계산</span>
<span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="n">b0</span><span class="o">/</span><span class="n">b2</span>
<span class="n">m</span> <span class="o">=</span> <span class="o">-</span><span class="n">b1</span><span class="o">/</span><span class="n">b2</span>

<span class="c1"># 분류 경계선의 그래프 값을 계산</span>
<span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">2.2</span>
<span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">2.2</span>
<span class="n">xd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">])</span>
<span class="n">yd</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">xd</span> <span class="o">+</span> <span class="n">c</span>

<span class="c1"># 데이터의 산점도</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">lawn_mower</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span> <span class="s2">&quot;income&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span> <span class="s2">&quot;lotsize&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;buy&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;deep&quot;</span><span class="p">)</span>

<span class="c1"># 새로운 고객</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.079000</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.020608</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

<span class="c1"># 분류 경계선 그리기</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xd</span><span class="p">,</span> <span class="n">yd</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Decision Boundary&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xd</span><span class="p">,</span> <span class="n">yd</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xd</span><span class="p">,</span> <span class="n">yd</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7ff2d6dbbb50&gt;
</pre></div>
</div>
<img alt="../../_images/classification_30_1.png" src="../../_images/classification_30_1.png" />
</div>
</div>
</section>
<section id="id11">
<h3><span class="section-number">8.3.3.4. </span>분류를 위한 예측<a class="headerlink" href="#id11" title="Permalink to this headline">#</a></h3>
<p>이제 새로운 고객에 대한 예측을 수행해 보자. 새로운 고객의 연소득이 <code class="docutils literal notranslate"><span class="pre">income=70</span></code> 이고  주택의대지 면적이 <code class="docutils literal notranslate"><span class="pre">lotsize=19</span></code> 인 경우 아래 코드 <code class="docutils literal notranslate"><span class="pre">lawn_logistic_fit.predict(X_predict)</span></code> 의 결과가 1 이므로 성공(<span class="math notranslate nohighlight">\(\hat y=1\)</span>)으로 예측한다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">predict(x)</span></code> : 인자로 주어진 설명변수 행렬 <code class="docutils literal notranslate"><span class="pre">x</span></code> 에 대한 예측값(성공=1, 실패=0)을 구해준다.</p></li>
</ul>
<p>즉, 새로운 고객은 제초 트랙터를 구입할 것으로 예측한다는 의미이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_predict</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.07899982, 0.02060846]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_pred</span> <span class="o">=</span><span class="n">lawn_logistic_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_predict</span><span class="p">)</span>
<span class="n">new_pred</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1.])
</pre></div>
</div>
</div>
</div>
<p>적합된 로지스틱 모형을을 이용하여 학습자료에 대한 반응변수의 예측값을 구해보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">buy_pred</span> <span class="o">=</span> <span class="n">lawn_logistic_fit</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">buy_pred</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0., 0., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 1.,
       0., 0., 0., 0., 0., 0., 0.])
</pre></div>
</div>
</div>
</div>
<p>적합된 로지스틱 모형을을 이용하여 학습자료에 대한 반응변수의 예측값을 원래 데이터프레임 <code class="docutils literal notranslate"><span class="pre">lawn_mower</span></code> 에 열이름 <code class="docutils literal notranslate"><span class="pre">buy_pred</span></code> 로 새롭게 추가하였다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lawn_mower</span><span class="p">[</span><span class="s1">&#39;buy_pred&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">buy_pred</span><span class="p">,</span> <span class="n">new_pred</span><span class="p">])</span>
<span class="n">lawn_mower</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>income</th>
      <th>lotsize</th>
      <th>buy</th>
      <th>buy_pred</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.447666</td>
      <td>-0.236997</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.895331</td>
      <td>-0.923946</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.194866</td>
      <td>1.136900</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.368666</td>
      <td>0.793426</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.974331</td>
      <td>1.995586</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.190928</td>
      <td>0.106477</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2.080329</td>
      <td>-0.580472</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.753132</td>
      <td>1.480374</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.026333</td>
      <td>0.449951</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.290330</td>
      <td>0.793426</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>-0.921665</td>
      <td>1.308637</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.658332</td>
      <td>0.449951</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.342333</td>
      <td>0.278214</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>-0.826865</td>
      <td>0.793426</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>-0.194866</td>
      <td>-0.752209</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>-1.332464</td>
      <td>0.621689</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.816331</td>
      <td>-0.580472</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>-1.016464</td>
      <td>-0.580472</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>-0.479266</td>
      <td>-1.267420</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>-0.131666</td>
      <td>-0.236997</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>-1.111264</td>
      <td>-1.095683</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>-1.869662</td>
      <td>-0.065260</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>-0.921665</td>
      <td>-2.126106</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>-0.289666</td>
      <td>-1.782632</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>0.079000</td>
      <td>0.020608</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>위 데이터프레임 <code class="docutils literal notranslate"><span class="pre">lawn_mower</span></code> 을 보면 실제로 구입한 결과가 저장된 열 <code class="docutils literal notranslate"><span class="pre">buy</span></code>와 로지스틱 회귀식으로 추정된 예측값 <code class="docutils literal notranslate"><span class="pre">buy_pred</span></code> 의 값이 일치하지 않는 레코드가 4개가 있다.</p>
<p>즉, 위의 그림에서 분류 경계선을 기준으로 예측이 틀린 레코드가 4개가 나타나는 것이다.</p>
<p>학습자료가 총 24개의 레코드를 포함하고 있으므로 분류의 정확도는 <span class="math notranslate nohighlight">\((24-4)/24 = 0.83\)</span>, 즉 83% 로 말할 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lawn_mower</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">lawn_mower</span><span class="o">.</span><span class="n">buy</span> <span class="o">!=</span> <span class="n">lawn_mower</span><span class="o">.</span><span class="n">buy_pred</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">lawn_mower</span><span class="o">.</span><span class="n">buy</span><span class="o">.</span><span class="n">isnull</span><span class="p">())]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>income</th>
      <th>lotsize</th>
      <th>buy</th>
      <th>buy_pred</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.447666</td>
      <td>-0.236997</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.895331</td>
      <td>-0.923946</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.342333</td>
      <td>0.278214</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.816331</td>
      <td>-0.580472</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">24</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="mi">24</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8333333333333334
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id12">
<h2><span class="section-number">8.3.4. </span>기계학습 모형<a class="headerlink" href="#id12" title="Permalink to this headline">#</a></h2>
<p>로지스틱 회귀모형으로 분류를 위한 예측을 하는 경우 분류 경계선이 독립변수의 복잡한 변화에 따라 유연하게 변화하지 못한다. 제초 트랙터 예제에서 볼 수 있듯이 로지스틱 회귀모형은 두 개의 독립변수로 이루어진 평면에서  분류 경계선은 오직 직선으로만 추정된다.</p>
<p>이제 좀 더 유연한 분류 경계선을 구할 수 있는 몇 가지 기계학습 모형을 이용해 보자.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://ko.wikipedia.org/wiki/%EA%B2%B0%EC%A0%95_%ED%8A%B8%EB%A6%AC_%ED%95%99%EC%8A%B5%EB%B2%95"><strong>결정 나무</strong></a> (decision tree): 분류 경계선을 추정할 때 독립변수의 구간을 축차적으로 나누는 방법으로 분류의 방법이 나무를 거꾸로 세운 형태와 유사한 방법이다. 분류의 경계선이 독립변수가 만드는 공간에서 각 축에 대하여 수평으로 나타난다.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">DecisionTreeClassifier(max_depth=k)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_depth=k</span></code> 나무의 층 수를 지정하는 선택명령문</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://ko.wikipedia.org/wiki/K-%EC%B5%9C%EA%B7%BC%EC%A0%91_%EC%9D%B4%EC%9B%83_%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98"><strong>k-최근방이웃</strong></a> (k-nearest neighbor, KNN): 분류를 하는 경우 독립변수의 값들이 가장 가까운 k 개의 이웃 레코드를 선택하여 반응값의 평균으로 성공확률을 예측하는 방법이며 분류 경계선이 매우 유연하게 나타난다.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">KNeighborsClassifier(n_neighbors=k)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_neighbors=k</span></code> : 최근방이웃의 개수를 지정하는 선택명령문</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://ko.wikipedia.org/wiki/%EC%84%9C%ED%8F%AC%ED%8A%B8_%EB%B2%A1%ED%84%B0_%EB%A8%B8%EC%8B%A0"><strong>서포트 벡터 머신</strong></a> (support vector machine, Kernel SVM):  최대 마진 초평면 문제에 커널 추정을 적용하는 비선형 분류 방법이며 분류 경계선이 비선형으로 나타난다.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">SVC(gamma=0.1,</span> <span class="pre">kernel=&quot;rbf&quot;,</span> <span class="pre">probability=True)</span></code></p></li>
</ul>
</li>
</ul>
<p>이제 위에서 사용한 로지스틱 회귀모형을 포함해서 4개의 기계학습 모형을 정의하고 제초 트랙터 자료를 적합하여 예측 모형을 추정하자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 기계학습 모형의 정의</span>
<span class="n">model_logistic</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">model_tree</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">model_knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">model_svm</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s2">&quot;rbf&quot;</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 모형의 적합</span>
<span class="n">model_logistic</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">model_tree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">model_knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">model_svm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SVC(gamma=0.1, probability=True)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 각 모형에 대한 분류 경계선 그림 그리기 </span>
<span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">*</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">*</span><span class="mf">1.2</span>
<span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">*</span><span class="mi">1</span><span class="p">,</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">*</span><span class="mf">1.2</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>

<span class="n">f</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s2">&quot;col&quot;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s2">&quot;row&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">clf</span><span class="p">,</span> <span class="n">tt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
    <span class="n">product</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span>
    <span class="p">[</span> <span class="n">model_logistic</span><span class="p">,</span> <span class="n">model_tree</span><span class="p">,</span> <span class="n">model_knn</span><span class="p">,</span> <span class="n">model_svm</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;Logisitc Reg&quot;</span><span class="p">,</span><span class="s2">&quot;Decision Tree (depth=3)&quot;</span><span class="p">,</span> <span class="s2">&quot;KNN (k=7)&quot;</span><span class="p">,</span> <span class="s2">&quot;Kernel SVM&quot;</span><span class="p">],</span>
<span class="p">):</span>

    <span class="n">Z</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">xx</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">yy</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="n">axarr</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">axarr</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
    <span class="n">axarr</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">tt</span><span class="p">)</span>
    <span class="n">axarr</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.079000</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.020608</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/classification_44_0.png" src="../../_images/classification_44_0.png" />
</div>
</div>
<p>이제 4개의 적합된 모형으로 새로운 고객에 대한 예측을 수행해보자.  결정 나무 모형을 제외하고 모두 제초 트랙터를 구입할 것이리고 예측하였다.</p>
<p>예측은 적합된 모형에 <code class="docutils literal notranslate"><span class="pre">predict(x)</span></code> 메소드를 사용한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 새로운 고객에 대한 예측</span>
<span class="n">y_pred_New</span> <span class="o">=</span> <span class="p">[</span><span class="n">model_logistic</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_predict</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">model_tree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_predict</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">model_knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_predict</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">model_svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_predict</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="p">]</span>
<span class="n">df_new_pred</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Logisitc&quot;</span><span class="p">,</span><span class="s2">&quot;Decision Tree&quot;</span><span class="p">,</span> <span class="s2">&quot;KNN&quot;</span><span class="p">,</span> <span class="s2">&quot;Kernel SVM&quot;</span><span class="p">],</span> <span class="s1">&#39;y_pred&#39;</span><span class="p">:</span> <span class="n">y_pred_New</span><span class="p">})</span>

<span class="n">df_new_pred</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>model</th>
      <th>y_pred</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Logisitc</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Decision Tree</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>KNN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kernel SVM</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>참고로 결정 나무 모형에서 분류 절차를 시각화하면 다음과 같이 나타낼 수 있다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">X[0]</span></code> 는 ‘income<code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">'X[1]</span></code> 은 <code class="docutils literal notranslate"><span class="pre">lotsize</span></code> 를 나타낸다.</p></li>
<li><p>상자 안에 맨 윗줄에 나온 조건이 만족하면 왼쪽 아래 상자로 이동한다. 이 경우가 <span class="math notranslate nohighlight">\(\hat y=0\)</span> 으로 분류되는 것이다.</p></li>
<li><p>상자 안에 맨 윗줄에 나온 조건이 만족하지 않으면 오른쪽 아래 상자로 이동한다. 이 경우가 <span class="math notranslate nohighlight">\(\hat y=1\)</span> 으로 분류되는 것이다.</p></li>
<li><p>상자 안의 마지막에 <code class="docutils literal notranslate"><span class="pre">Value</span> <span class="pre">=</span> <span class="pre">[a,b]</span></code> 는 <span class="math notranslate nohighlight">\(\hat y=0\)</span> 으로 분류된 레코드가 <code class="docutils literal notranslate"><span class="pre">a</span></code> 개, <span class="math notranslate nohighlight">\(\hat y=1\)</span> 으로 분류된 레코드가 <code class="docutils literal notranslate"><span class="pre">b</span></code> 개라느 의미이다.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tree</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">(</span><span class="n">model_tree</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[Text(279.0, 332.955, &#39;X[0] &lt;= -0.463\ngini = 0.5\nsamples = 24\nvalue = [12, 12]&#39;),
 Text(139.5, 237.825, &#39;X[1] &lt;= 1.051\ngini = 0.219\nsamples = 8\nvalue = [7, 1]&#39;),
 Text(69.75, 142.695, &#39;gini = 0.0\nsamples = 7\nvalue = [7, 0]&#39;),
 Text(209.25, 142.695, &#39;gini = 0.0\nsamples = 1\nvalue = [0, 1]&#39;),
 Text(418.5, 237.825, &#39;X[1] &lt;= 0.364\ngini = 0.43\nsamples = 16\nvalue = [5, 11]&#39;),
 Text(348.75, 142.695, &#39;X[0] &lt;= 0.856\ngini = 0.494\nsamples = 9\nvalue = [5, 4]&#39;),
 Text(279.0, 47.565, &#39;gini = 0.278\nsamples = 6\nvalue = [5, 1]&#39;),
 Text(418.5, 47.565, &#39;gini = 0.0\nsamples = 3\nvalue = [0, 3]&#39;),
 Text(488.25, 142.695, &#39;gini = 0.0\nsamples = 7\nvalue = [0, 7]&#39;)]
</pre></div>
</div>
<img alt="../../_images/classification_48_1.png" src="../../_images/classification_48_1.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters/08"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="regression.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">8.2. </span>선형 회귀모형</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="validation.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">8.4. </span>분류의 평가</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By 서울시립대학교<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>