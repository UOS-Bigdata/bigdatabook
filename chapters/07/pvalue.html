

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>7.2. 유의성 검정 &#8212; 빅데이터 개론 2</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystyle.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/07/pvalue';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="7.3. 두 그룹의 비교" href="abtest.html" />
    <link rel="prev" title="7.1. 선택과 증거" href="decision.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    빅데이터 개론 2
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../01/intro-course.html">1. 서론</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../01/intro-program.html">1.1. 프로그래밍 언어</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01/intro-stat.html">1.2. 통계학</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../02/intro-python.html">2. 파이선의 기초</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../02/basic-expression.html">2.1. 표현식과 변수</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02/data-processing-intro.html">2.2. 데이터의 처리</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02/data-processing-train-passenger.html">2.3. 고속열차 여객 수송자료</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02/data-processing-text.html">2.4. 어린 왕자</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../03/types.html">3. 자료의 형식</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../03/numbers.html">3.1. 숫자</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/string.html">3.2. 문자열</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/array.html">3.3. 행렬</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../04/dataframe.html">4. 데이터프레임</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../04/dataframe-intro.html">4.1. 데이터프레임의 정의와 구성요소</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/dataframe-change.html">4.2. 데이터프레임의 정리</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/dataframe-summary.html">4.3. 데이터프레임의 요약</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/dataframe-merge.html">4.4. 데이터프레임의 결합</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../05/data-intro.html">5. 분포와 확률</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../05/data_distribution.html">5.1. 자료의 분포</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05/data_randomness.html">5.2. 분포와 우연성</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05/data_random_experiment.html">5.3. 확률과 컴퓨터 실험</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05/data_probability.html">5.4. 확률의 기초</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05/data_function.html">5.5. 함수</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../06/sampling-intro.html">6. 표본과 경험적 분포</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../06/sample.html">6.1. 표본과 정보</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/samplemeans.html">6.2. 통계량의 분포</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/estimator.html">6.3. 추정량의 성질</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/bootstrap.html">6.4. 붓스트랩</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="test-intro.html">7. 유의성 검정</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="decision.html">7.1. 선택과 증거</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">7.2. 유의성 검정</a></li>
<li class="toctree-l2"><a class="reference internal" href="abtest.html">7.3. 두 그룹의 비교</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../08/relation-intro.html">8. 관계와 예측</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../08/correlation.html">8.1. 두 변수의 관계</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08/regression.html">8.2. 선형 회귀모형</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08/classification.html">8.3. 분류와 예측모형</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08/validation.html">8.4. 분류의 평가</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/UOS-Bigdata/bigdatabook/blob/master/chapters/07/pvalue.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/UOS-Bigdata/bigdatabook" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/chapters/07/pvalue.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>유의성 검정</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">7.2.1. 달인의 기준</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fisher">7.2.2. Fisher의 생각</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">7.2.3. 유의성 검정</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#p">7.2.4. p-값의 계산</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">7.2.5. 예제: 모의실험을 통한 p-값의 근사</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">7.2.5.1. 차부인 실험의 확장</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">7.2.5.2. 쇼핑몰 알고리즘의 개선</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">7.2.5.3. 정확한 p-값의 계산</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1><span class="section-number">7.2. </span>유의성 검정<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h2><span class="section-number">7.2.1. </span>달인의 기준<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<p>TV 프로그램 중 생활의 달인을 보면 보통 사람들이 가질 수 없는 특별한 능력을 가진 사람들이 있습니다. 특히 공장에서 불량품을 검수하시는 분들의 능력을 보면 우리가 <strong>깜짝 놀랄만한 특별한 능력</strong> 을 보여줍니다.</p>
<p>이제 우리는 “생활의 달인”과 “보통 사람”을 구별할 수 있는 기준에 대하여 생각해 봅시다. 생활의 달인 프로그램을 보면 마지막에 다양한 형태의 “실험”을 통하여 달인의 능력을 검증하기도 합니다. 주어진 제품의 모양을 숨기기 위하여 눈을 가리는 등 공정한 조건에서 실험을 하는 노력을 합니다.</p>
<p>통계학의 아버지라고 불리는 R. A. Fisher 는 20세기 초반에 영국의 Rothamsted 에 있는 농업연구소에서 근대 통계학의 근간이 되는 중요한 개념을 정립한 통계학자이자 유전학자입니다.</p>
<p>Fisher가 근무하는 연구소에도 생활의 달인 임을 주장하는 사람이 있었습니다. 연구소에 근무하는 부인이 자신은 우유를 넣은 차(milk tea)를 마셔보면 우유를 먼저 컵에 따랐는지, 차를 먼저 따랐는지 구별할 수 있다고 주장했습니다. 이에 Fisher 는 작은 실험을 준비하여 부인의 눙력을 검증하자고 제안합니다. 실험은 다음과 같습니다.</p>
<ul class="simple">
<li><p>8개의 컵을 준비하고 4잔은 우유를 먼저 따르고, 나머지 4잔은 차를 먼저 따른다.</p></li>
<li><p>차와 우유가 잔에 따라진 순서를 모르게 하여 부인에게 우유를 먼저 따른 4잔을 선택하게 한다.</p></li>
</ul>
<p>후에 전해진 <a class="reference external" href="https://en.wikipedia.org/wiki/Lady_tasting_tea">실험의 결과</a> 에 의하면 부인은 우유를 먼저 따른 4잔을 정확하게 선택했다고 합니다.</p>
<p>여러분은 이 부인을 생활의 달인이라고 인정할 수 있나요? 즉 실험의 결과가 부인이 특별한 능력을 가졌다는 충분한 근거가 있는 것인가요?</p>
<p>만약 8잔이 아니라 100잔을 가지고 실험했을 때 우유를 먼저 따른 50잔을 모두 맞추었다면 우리는 이 부인이 생활의 달인이라는데 이견이 없을 겁니다. 하지만 달인도 실수는 할 수 있습니다 (TV 프로그램에도 까끔 달인분들이 실수하지요). 만약 48잔을 맞추고 2잔은 틀렸다면 이는 달인의 기준에 드는 걸까요? 만약 45잔을 맞추고 5잔은 틀렸다면 어떻게 판단할까요?</p>
</section>
<section id="fisher">
<h2><span class="section-number">7.2.2. </span>Fisher의 생각<a class="headerlink" href="#fisher" title="Permalink to this heading">#</a></h2>
<p>사람들은 동일한 실험 결과를 보고 다른 의사 결정을 할 수 있습니다. 만약 만약 45잔을 맞추고 5잔은 틀렸을 때, 어떤 사람들은 부인의 능력을 충분히 보여주었다고 주장할 수 있지만 어떤 사람들은 50잔을 모두 맞추어야 달인의 자격이 있다고 주장할 수 있습니다.</p>
<p>이렇게 같은 증거에 대하여 사람들의 의사결정이 다를 수 있는 이유는 <strong>“달인의 능력”에 대한 기준</strong>이 다르기 때문입니다. 사람들마다 생각하는 달인의 기준이 다르다면 동일한 데이터를 가지고 서로 다른 의사결정을 할 수 밖에 없습니다.</p>
<blockquote>
<div><p>수집한 데이터의 정보가 “달인의 기준”에 얼마나 가까이 있는가?</p>
</div></blockquote>
<p>Fisher는 의사 결정에서 주관성을 제거하기 위하여 <strong>“달인이 가진 능력”</strong> 이 아닌 <strong>“보통 사람이 가진 능력”</strong> 으로 판단의 기준을 바꿉니다.</p>
<blockquote>
<div><p>수집한 데이터의 정보가 “보통 사람의 기준”에서 얼마나 멀리 있는가?</p>
</div></blockquote>
<p>Fisher 가 제시한 판단의 기준이 되는 보통 사람의 능력은 많은 경우 객관적으로 정의될 수 있습니다. 보통 사람인 여러분들은 8개의 잔 중 우유를 먼저 따른 잔 4개를 선택하라고 하면 어떻게 선택할 것입니까? 필자도 한 번 시도해았지만 우리의 능력으로는 도저히 맛을 보고 선택할 수 없습니다. 따라서 여러분은 답에 대하여 전혀 힌트가 없는 경우 4지선다형 문제를 풀때 처럼 <strong>임의로 4잔을 선택(randomly selected)</strong> 할 수 밖에 없습니다. 즉 보통 사람의 능력은 선택을 임의로 하는 것입니다.</p>
<p>보통 사람인 여러분이 차부인(tea lady)의 실험에 참가해서 우유를 먼저 따른 4잔을 정확하게 선택한다면
여러분은 아마도 깜짝 놀랄 것입니다. 왜냐하면 보통 사람이 가진 능력의 기준으로는 매우 일어나기 힘든 일이 벌어졌기 때문입니다.</p>
<p>이렇게 Fisher는 다음과 같은 의사결정의 방법을 제시했습니다. 이러한 방법을 <strong>Fisher의 유의성 검정(significnace test)</strong> 라고 합니다.</p>
<blockquote>
<div><p>보통 사람이 가진 능력을 기준으로 매우 일어나기 힘든 결과를 얻었다면, 그 결과는 보통 사람에 의한 것이 아니라 달인의 능력이라고 판단하자!!</p>
</div></blockquote>
</section>
<section id="id3">
<h2><span class="section-number">7.2.3. </span>유의성 검정<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h2>
<p>그럼 Fihser 가 생각하는 “보통 사람이 가진 능력으로는 매우 일어나기 힘든 결과가 일어났다” 를 판단하는 기준은 무었일까요?</p>
<p>차부인(tea lady)의 실험에서 보통 사람이 <strong>임의로 4잔을 선택</strong> 한다면 차부인이 보여준 4잔을 모두 맞추는 가능성이 얼마나 될까요?</p>
<p>보통 사람이 8개의 잔에서 임의로 4잔을 선택하는 경우의 수는 모두 70개입니다. 임의로 선택하였기 때문에 70 개의 경우는 모두 같은 가능성(equally likely)을 가집니다.</p>
<div class="math notranslate nohighlight">
\[ {{8}\choose{4}} = \frac{(8)(7)(6)(5)}{(4)(3)(2)(1)} =70 \]</div>
<p>이때 차부인이 보여준 4잔을 모두 맞추는 경우는 딱 1가지 입니다. 8개의 잔에서 4개를 임의로 선택할 때  우유를 먼저 따른  4개를 제대로 선택할 경우의 수는 마치 여러분이 상자에 하얀 공 4개외 검은 공 4개가 들어있는 경우, 4개를 임의로 선택할 때 하얀 공 4개를 선택하는 경우의 수와 같습니다.</p>
<div class="math notranslate nohighlight">
\[ {{4}\choose{4}} {{4}\choose{0}} = 1 \]</div>
<p>따라서 보통 사람이 가진 능력을 기준으로 4잔을 모두 맞추는 가능성을 확률로 나타내면 <span class="math notranslate nohighlight">\(1/70\)</span> 입니다.</p>
<div class="math notranslate nohighlight">
\[ p-value = \frac{1}{70} = 0.0143 \]</div>
<p>Fisher 의 논리는 <strong>보통 사람이 가진 능력을 기준으로 실험의 결과가 나타날 확률, 즉 4잔을 모두 맞출 확률을 p-값(p-value)</strong> 으로 부르며 이 p-값이 미리 정한 수준보다 작으면 달인으로 인정하자는 것입니다.</p>
<p>유의성 검정에서 판단에 사용하는 수준을 <strong>유의수준(significnace level)</strong> 이라고 부르며 우리는 통상적으로 5%, 즉 확률 0.05 를 사용하고 있습니다. 보통 사람의 기준으로 깜짝 놀랄 일이 벌어지는 가능성의 기준이 바로 유의수준입니다.</p>
<p>Fisher 가 가정한 “차부인은 보통 사람이다” 라는 가설을 우리는 일반적으로 <strong>귀무가설(null hypothesis)</strong> 라고 부릅니다. 즉, 차부인의 주장과는 반대되는 가설이며 이는 우리와 Fisher가 자연스럽게 차부인의 주장을 의심하면서 가지는 생각을 나타냅니다. p-값이 유의수준보다 작으면 귀무가설을 기각(reject)한다고 말하며 이는 귀무가성을 포기하고 달인으로 인전한다는 의미입니다.</p>
<p>차부인 실험에 Fisher 의 유의성 검정을 적용하는 절차는 다음과 같습니다.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>유의성 검정의 순서</p></th>
<th class="head text-left"><p>차부인 실험</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>귀무가설을 세운다</p></td>
<td class="text-left"><p>차부인은 보통 사람이다</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>실험을 실시하여 데이터를 얻는다</p></td>
<td class="text-left"><p>8잔 중 우유를 먼저 따른 4잔을 정확하게 선택</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>귀무가설 하에서 결과 데이터가 관측되는 p-값을 계산한다</p></td>
<td class="text-left"><p>p-값은 1/70 =0.0143</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>p-값과 유의수준 5% 를 비교한다</p></td>
<td class="text-left"><p>p-값=0.0143 &lt; 0.05</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>귀무가설을 기각한다.</p></td>
<td class="text-left"><p>차부인은 보통 사람이 아니다, 즉 생활의 달인이다</p></td>
</tr>
</tbody>
</table>
</section>
<section id="p">
<h2><span class="section-number">7.2.4. </span>p-값의 계산<a class="headerlink" href="#p" title="Permalink to this heading">#</a></h2>
<p>이제 여러분들이 차부인 실험과 동일한 실험을 실시해서 우유를 먼저 따른 4개의 잔 중에서 3개를 제대로 선택하고 나머지 1개를 잘못 선택하였다고 합시다.</p>
<p>이러한 경우 p-값은 어떻게 계산할까요?</p>
<p>우유를 먼저 따른 4개의 잔 중에서 3개를 제대로 선택하고 나머지 1개를 잘못 선택할 경우의 수는  상자에 하얀 공 4개와 검은 공 4개가 들어있는 경우, 4개를 임의로 선택할 때 하얀 공 3개와 검은 공 1개를 선택하는 경우의 수와 같습니다. 즉</p>
<div class="math notranslate nohighlight">
\[ {{4}\choose{3}} {{4}\choose{1}} = (4)(4) = 16 \]</div>
<p>하얀 공 3개와 검은 공 1개를 선택하는 확률은 <span class="math notranslate nohighlight">\(16/70=0.2286\)</span>입니다.</p>
<div class="math notranslate nohighlight">
\[ \frac{16}{70} = 0.2286 \]</div>
<p>우유를 먼저 따른 4개의 잔 중에서 3개를 제대로 선택하고 나머지 1개를 잘못 선택한 경우 p-값을 계산하는 방법은 다음과 같습니다.</p>
<div class="math notranslate nohighlight">
\[ p-value = P ( \text{실험에서 얻은 결과 또는}  \text{더 극단적인 결과들}) \]</div>
<p>즉, 이 경우 p-값은 실험에서 얻은 결과(3개를 제대로 선택하고 나머지 1개를 잘못 선택한 사건)의 확률에 이 보다 더 극단적인 결과들(더 놀랄 사건들, 즉 4개를 모두 제대로 선택한 사건)의 확률을 더해서 구하게 됩니다.</p>
<div class="math notranslate nohighlight">
\[ p-value = \frac{16 + 1}{70} =0.2428 \]</div>
<p>이 경우 p-값이 5% 보다 크기 때문에 귀무가설을 기각하지 못합니다. 즉, 4개 중에서 3개만 제대로 선택하는 경우는 달인이라고 할 수 없다는 것입니다.</p>
<p>4개 중에서 3개만 제대로 선택하는 경우 Fisher 의 유의성 검정을 적용하는 절차는 다음과 같습니다.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>유의성 검정의 순서</p></th>
<th class="head text-left"><p>차부인 실험</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>귀무가설을 세운다</p></td>
<td class="text-left"><p>이용희는 보통 사람이다</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>실험을 실시하여 데이터를 얻는다</p></td>
<td class="text-left"><p>먼저 따른 3잔을 제대로 선택하고 나머지 1잔은 잘 못 선택</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>귀무가설 하에서 결과 데이터가 관측되는 p-값을 계산한다</p></td>
<td class="text-left"><p>p-값은 17/70 =0.2428</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>p-값과 유의수준 5% 를 비교한다</p></td>
<td class="text-left"><p>p-값=0.2428 &gt; 0.05</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>귀무가설을 기각하지 못한다.</p></td>
<td class="text-left"><p>이용희는 보통 사람이다</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id4">
<h2><span class="section-number">7.2.5. </span>예제: 모의실험을 통한 p-값의 근사<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h2>
<section id="id5">
<h3><span class="section-number">7.2.5.1. </span>차부인 실험의 확장<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<p>20개의 잔 중 10잔은 우유를 먼저 따르고, 나머지 10잔은 차를 먼저 따랐다. 친구가 우유를 따른 잔 10개중 8개를 제대로 선택하였다고 하자. 친구는 달인인가?</p>
<p>먼저 p-값을 이론적으로 구하려면 다음과 같이 구할 수 있다.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
 p-value &amp;  = P( \text{잔 8개를 제대로 선택한 사건 또는 더 극단적인 사건들}) \\ 
  &amp; = P( \text{잔 8개를 제대로 선택한 사건} ) + P( \text{잔 9개 제대로 선택한 사건}) + P( \text{잔 10개 제대로 선택한 사건})  \\ 
  &amp; = \frac{    {{10}\choose{8}}  {{10}\choose{2}}  } {{20}\choose{10}} + 
  \frac{  {{10}\choose{9}}  {{10}\choose{1}}   }  { {20}\choose{10} } + 
  \frac{  {{10}\choose{10}}  {{10}\choose{0}}  }  { {20}\choose{10} }
\end{align*} 
\end{split}\]</div>
<p>물론 위의 계산을 정확하게 구할 수도 있겠지만 모의실험을 통해서 근사적으로 구할 수 있다. 앞 장에서 지지율에 대한 모의실험을 한 것 처럼, 각각 10개의 0과 1로 구성된 20개의 자료에서 10개를 비복원으로 추출하는 모의실험을 반복적으로 수행하여 위의 확률을 근사적으로 구해보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_cups</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">n_cups_milk_first</span> <span class="o">=</span> <span class="mi">10</span>
<span class="c1"># 1 =우유 먼저, 0=차 먼저</span>
<span class="n">CUPS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_cups_milk_first</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_cups</span> <span class="o">-</span> <span class="n">n_cups_milk_first</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">CUPS</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 아래 모의실험은 시간이 7-8초 소요된다.</span>

<span class="c1"># 모의실험의 횟수</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">100000</span> 

<span class="c1"># 실험에서 얻은 결과 </span>
<span class="n">observed_val</span> <span class="o">=</span> <span class="mi">8</span>

<span class="c1">## 먼저 우유를 넣은 잔을 제대로 선택한 개수를 저장할 데이터프레임</span>
<span class="n">milk_estimate</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;milk&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">B</span><span class="p">)})</span>

<span class="c1">## 모의실험 : 비복원추출에 유의</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">B</span><span class="p">):</span>
  <span class="n">sample_milk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">CUPS</span><span class="p">,</span> <span class="n">n_cups_milk_first</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">milk_estimate</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;milk&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">sample_milk</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">milk_estimate</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>milk</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 관측한 결과 또는 더 극단적인 사건의 개수</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">milk_estimate</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">milk_estimate</span><span class="o">.</span><span class="n">milk</span> <span class="o">&gt;=</span> <span class="n">observed_val</span> <span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1127
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 모의실험에 의한 p-값의 근사 </span>
<span class="n">pvalue</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="n">B</span>
<span class="n">pvalue</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.01127
</pre></div>
</div>
</div>
</div>
<p>위에서 근사적으로 구한 p-값이 유의수준 5%, 즉 <span class="math notranslate nohighlight">\(0.05\)</span> 보다 작으므로 친구가 우유를 먼저 넣은 잔을 구별하는 능력이 있다고 판단한다.</p>
</section>
<section id="id6">
<h3><span class="section-number">7.2.5.2. </span>쇼핑몰 알고리즘의 개선<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h3>
<p>다른 예제를 생각해 보자.</p>
<p>온라인 쇼핑몰을 운영하는 회사가 2020년 매달에 임의로 1000명의 고객에 대하여 접속 기록을 분석하여 접속 후 장바구니에 상품을 저장했던 고객이 평균적으로 540명인 것을 알고있다. 2021년 1월부터 고객이 장바구니를 선택하는 절차를 개선한 알고리즘을 새롭게 개발하고 온라인 쇼핑몰의 운용에 적용하였다.</p>
<p>2021년 1월부터 10월까지 매월 임의로 1000명의 고객에 대하여 접속 기록을 분석하여 접속 후 장바구니에 상품을 저장했던 평균 고객 수가 620 명으로 늘어난 사실을 확인하였다. 쇼핑몰의 알고리즘 개선 후 늘어난 장바구니 사용 회수가 유의한 증가(significant increase)인지 아닌지 판단해보자.</p>
<p>참고로 여러분이 온라인 쇼핑몰을 이용해 보았다면 장버구니에 상품을 저장했더라고 구매를 하지 않는 경우도 많다는 것에 유의하자. 하지만
관심있는 상품을 장바구니에 담기 쉽고 장바구니 안에서 선택한 상품들의 관리와 선택이 편리하다면 구매로 이어질 가능성이 클 것이다.</p>
<p>일단 기존의 알고리즘에 의한 장바구니 평균 이용율은 54%이다.</p>
<div class="math notranslate nohighlight">
\[ \frac{540}{1000} = 0.54 \]</div>
<p>장바구니를 이용한 평균적인 이용률이 54% 인 것을 가정하고 <strong>1명의 고객이 장바구니를 이용할 확률 <span class="math notranslate nohighlight">\(p\)</span> 가 0.54</strong> 로 하는 귀무가설을 고려하자.</p>
<div class="math notranslate nohighlight">
\[ \text{귀무가설: } p= 0.54 \]</div>
<p>이제 귀무가설이 참인 경우, 즉 <span class="math notranslate nohighlight">\(p=0.54\)</span> 인 경우 1000명의 고객이 장바구니를 이용하는 횟수 <span class="math notranslate nohighlight">\(X\)</span> 에 대한 분포를 생각해 보자. 이제  한 명의 고객이 장바구니를 이용할 <span class="math notranslate nohighlight">\(0.54\)</span> 이며 고객들 간에 행동이 서로 관련이 없다고 가정하면, 장바구니를 이용하는 횟수 <span class="math notranslate nohighlight">\(X\)</span>의 분포는 앞면이 나올 확률이 0.54 인 동전을 독립적으로 1000번 던질 때 앞면의 나오는 횟수의 분포와 동일하다.</p>
<p>이렇게 성공의 확률이 <span class="math notranslate nohighlight">\(p\)</span>인 사건을 <span class="math notranslate nohighlight">\(n\)</span> 번 독립적으로 시행할 때 나타나는 성공의 횟수 <span class="math notranslate nohighlight">\(X\)</span>의 분포는 이항분포(Binomial distribution)을 따른다고 한다.</p>
<div class="math notranslate nohighlight">
\[ X \sim Binomail(n,p) \]</div>
<p>이항분포의 확률은 다음과 같이 계산한다.</p>
<div class="math notranslate nohighlight">
\[ P(X=m) = {{n}\choose{m}} p^m (1-p)^{n-m}, \quad m=0,1,2,\dots, n \]</div>
<p>귀무가설이 참인 경우, 즉 고객이 장바구니를 이용할 확률 <span class="math notranslate nohighlight">\(p\)</span> 가 0.54 인 경우,  1000명의 고객 중에서 장버구니 이용자의 수가 620 명 또는 그 이상 나올 확률이 p-값이며 이론적으로 다음과 같이 구할 수 있다.</p>
<div class="math notranslate nohighlight">
\[ p-value = P(X \ge 620) = \sum_{m=620}^{1000} {{1000}\choose{m}} (0.54)^m (1-0.54)^{1000-m} \]</div>
<p>위의 값은 실제로 아주 작은 수이다. 위의 p-값을 구하는 여러 가지 방법이 있지만 우리가 앞에서 배운 모의실험 방법으로 구해보자.</p>
<div class="math notranslate nohighlight">
\[ p-value \approx \frac{\text{number of cases for } X \ge 620}{\text{number of simulation}} \]</div>
<p>모의실험은 라이브러리 <code class="docutils literal notranslate"><span class="pre">numpy</span></code>의 <code class="docutils literal notranslate"><span class="pre">random.binomial(n,p,size)</span></code> 함수를 이용할 것이다. 함수 <code class="docutils literal notranslate"><span class="pre">random.binomial</span></code> 는 성공 확률이 <span class="math notranslate nohighlight">\(p\)</span>인 사건을 <span class="math notranslate nohighlight">\(n\)</span> 번 독립적으로 시행할 때 나타나는 성공의 횟수를 <code class="docutils literal notranslate"><span class="pre">size</span></code> 만큼 반복적으로 모의실험해주는 함수이다.</p>
<p>1000명의 고객이 독립적으로 장바구니를 이용할 확률이 0.54인 경우, 즉  이용자의 수 <span class="math notranslate nohighlight">\(X\)</span>가 이항분포 <span class="math notranslate nohighlight">\(Binomial(1000,0.54)\)</span>를 따르는 경우 난수(random number)를 발생시켜 보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 난수 1개를 발생시키는 경우 - 아래 코드를 반복적으로 실행시키면서 난수가 어떻게 변하는지 보자 </span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([522])
</pre></div>
</div>
</div>
</div>
<p>이제 1000명의 고객이 각각 장바구니를 이용할 확률이 0.54인 경우 이용자의 수를 모의실험을 통하여 B=100000 번 발생시킨다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="mi">100000</span>
<span class="n">bionomial_counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span> <span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bionomial_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([513, 536, 545, ..., 537, 536, 521])
</pre></div>
</div>
</div>
</div>
<p>이제 모의실험으로 발생시킨 10000개의 이용자 수에 대한 분포를 히스토그램으로 그려보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bionomial_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;count&#39;</span><span class="p">:</span><span class="n">bionomial_counts</span><span class="p">})</span>
<span class="n">bionomial_df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:ylabel=&#39;Frequency&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/5f2b37208ea14591dcc82d1cbca40ec3c54ccb63ef05e2a8105572ff73cbd9fe.png" src="../../_images/5f2b37208ea14591dcc82d1cbca40ec3c54ccb63ef05e2a8105572ff73cbd9fe.png" />
</div>
</div>
<p>위에서 B=10000 번의 모의실험에서 성공의 횟수가 620명 이상인 비율을 구해보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">observed_count</span> <span class="o">=</span> <span class="mi">620</span>
<span class="n">bionomial_counts</span> <span class="o">&gt;=</span> <span class="n">observed_count</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([False, False, False, ..., False, False, False])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">bionomial_counts</span> <span class="o">&gt;=</span> <span class="n">observed_count</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">bionomial_counts</span> <span class="o">&gt;=</span> <span class="n">observed_count</span><span class="p">)</span><span class="o">/</span><span class="n">B</span>
<span class="n">p_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_value</span> <span class="o">&lt;</span> <span class="mf">0.05</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>이제 위의 모의실험에서 1000명의 고객이 각각 장바구니를 이용할 확률이 0.54인 경우 모의실험으로 구한 B=10000개 의 이용자 수들 중에 620 명 이상이 나올 확률은 근사적으로 0으로 나타났다. 근사적이라는 의미는 정확한 확률이 0 아니라 B=10000 번 모의실험한 경우 한번도 나타나지 않았다는 것이다.</p>
<p>p-값의 근사값은 0 이고 유의수준 0.05 보다 작으므로 알고리즘 적용 후 고객이 장바구니를 이용할 확률은 0.54 보다 커졌다고 판단할 수 있다.</p>
<p>유의성 검정의 결과를 다시 말하면, 평균 이용율이 54%인 경우 1000명의 고객 중 620명 이상의 고객들이 장바구니를 이용할 가능성은 거의 없으므로 귀무가설을 기각하고 이용율이 증가했다고 결론을 내릴 수 있다.</p>
</section>
<section id="id7">
<h3><span class="section-number">7.2.5.3. </span>정확한 p-값의 계산<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h3>
<p>이항분포에 대한 확률을 계산하기 위해서는 <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> 라이브러리의  <code class="docutils literal notranslate"><span class="pre">binom</span></code> 객체를 이용해야 한다. 아래 코드에서 <code class="docutils literal notranslate"><span class="pre">binom.cdf(x,</span> <span class="pre">n,</span> <span class="pre">p)</span></code> 는 성공확률이 <code class="docutils literal notranslate"><span class="pre">p</span></code>인 경우  시행횟수가 <code class="docutils literal notranslate"><span class="pre">n</span></code>이고 성공의 회수가 <code class="docutils literal notranslate"><span class="pre">x</span></code> 와 같거나 작은 확률이다. <code class="docutils literal notranslate"><span class="pre">cdf</span></code> 는 누적분포함수(cumulative distribution function)의 줄임말이다.</p>
<div class="math notranslate nohighlight">
\[ \text{binom.cdf(x, n, p)} = \sum_{i=0}^x P(X =i) = P(X \le x) \]</div>
<p>위에서 p-값은 성공회수가 620개 또는 그 이상 일 확률이기 때문에 다음과 같이 여사건의 확률을 이용하여 정확하게 게산할 수 있다.</p>
<div class="math notranslate nohighlight">
\[ p-value = P(X \ge 620) = 1 - P(X \le 619) \]</div>
<p>아래 주어진 p-값의 정확한 값을 보면 <span class="math notranslate nohighlight">\(0.000000193\)</span>으로 매우 작으며 이러한 작은 확률의 시간은 B=10000 번의 모의실험으로는 1번이라도 나타나기 힘들다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span>

<span class="n">p_val_exact</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">binom</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">619</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mf">0.54</span><span class="p">)</span>
<span class="n">p_val_exact</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.929786053178617e-07
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters/07"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="decision.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">7.1. </span>선택과 증거</p>
      </div>
    </a>
    <a class="right-next"
       href="abtest.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">7.3. </span>두 그룹의 비교</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">7.2.1. 달인의 기준</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fisher">7.2.2. Fisher의 생각</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">7.2.3. 유의성 검정</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#p">7.2.4. p-값의 계산</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">7.2.5. 예제: 모의실험을 통한 p-값의 근사</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">7.2.5.1. 차부인 실험의 확장</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">7.2.5.2. 쇼핑몰 알고리즘의 개선</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">7.2.5.3. 정확한 p-값의 계산</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By 서울시립대학교
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>